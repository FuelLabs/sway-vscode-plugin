var Lo=Object.defineProperty;var Yo=(t,e,n)=>e in t?Lo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Rs=(t,e,n)=>(Yo(t,typeof e!="symbol"?e+"":e,n),n);import{ab as qo,a8 as Ho,ac as Ne,ad as Re,ae as Oe,p as Go,c as Wo,e as Vo,j as zo,d as Xo,N as Ht,a7 as Jo,A as En,t as Qo,a0 as Zo,U as ea,n as Os,s as ta,l as na,h as ra,af as sa,m as ia,f as oa,i as aa}from"./config-27341492.js";import{c as yi}from"./BaseConnection-538d8d30.js";const V=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,J=Object.keys,ie=Array.isArray;function ce(t,e){return typeof e!="object"||J(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||V.Promise||(V.Promise=Promise);const Gt=Object.getPrototypeOf,ca={}.hasOwnProperty;function he(t,e){return ca.call(t,e)}function wt(t,e){typeof e=="function"&&(e=e(Gt(t))),(typeof Reflect>"u"?J:Reflect.ownKeys)(e).forEach(n=>{Pe(t,n,e[n])})}const gi=Object.defineProperty;function Pe(t,e,n,r){gi(t,e,ce(n&&he(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function yt(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Pe(t.prototype,"constructor",t),{extend:wt.bind(null,t.prototype)}}}}const ua=Object.getOwnPropertyDescriptor;function ss(t,e){let n;return ua(t,e)||(n=Gt(t))&&ss(n,e)}const la=[].slice;function Nn(t,e,n){return la.call(t,e,n)}function vi(t,e){return e(t)}function Ct(t){if(!t)throw new Error("Assertion Failed")}function bi(t){V.setImmediate?setImmediate(t):setTimeout(t,0)}function wi(t,e){return t.reduce((n,r,s)=>{var i=e(r,s);return i&&(n[i[0]]=i[1]),n},{})}function Ce(t,e){if(he(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,s=e.length;r<s;++r){var i=Ce(t,e[r]);n.push(i)}return n}var o=e.indexOf(".");if(o!==-1){var a=t[e.substr(0,o)];return a===void 0?void 0:Ce(a,e.substr(o+1))}}function ye(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){Ct(typeof n!="string"&&"length"in n);for(var r=0,s=e.length;r<s;++r)ye(t,e[r],n[r])}else{var i=e.indexOf(".");if(i!==-1){var o=e.substr(0,i),a=e.substr(i+1);if(a==="")n===void 0?ie(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=n;else{var c=t[o];c&&he(t,o)||(c=t[o]={}),ye(c,a,n)}}else n===void 0?ie(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Ei(t){var e={};for(var n in t)he(t,n)&&(e[n]=t[n]);return e}const da=[].concat;function Si(t){return da.apply([],t)}const ki="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Si([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>V[t]),fa=ki.map(t=>V[t]);wi(ki,t=>[t,!0]);let Ke=null;function en(t){Ke=typeof WeakMap<"u"&&new WeakMap;const e=mr(t);return Ke=null,e}function mr(t){if(!t||typeof t!="object")return t;let e=Ke&&Ke.get(t);if(e)return e;if(ie(t)){e=[],Ke&&Ke.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(mr(t[n]))}else if(fa.indexOf(t.constructor)>=0)e=t;else{const i=Gt(t);for(var s in e=i===Object.prototype?{}:Object.create(i),Ke&&Ke.set(t,e),t)he(t,s)&&(e[s]=mr(t[s]))}return e}const{toString:ha}={};function _r(t){return ha.call(t).slice(8,-1)}const yr=typeof Symbol<"u"?Symbol.iterator:"@@iterator",pa=typeof yr=="symbol"?function(t){var e;return t!=null&&(e=t[yr])&&e.apply(t)}:function(){return null},_t={};function Ae(t){var e,n,r,s;if(arguments.length===1){if(ie(t))return t.slice();if(this===_t&&typeof t=="string")return[t];if(s=pa(t)){for(n=[];!(r=s.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const is=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Ee=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xi(t,e){Ee=t,Ti=e}var Ti=()=>!0;const ma=!new Error("").stack;function ft(){if(ma)try{throw ft.arguments,new Error}catch(t){return t}return new Error}function gr(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Ti).map(r=>`
`+r).join("")):""}var Ri=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],os=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ri),_a={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function gt(t,e){this._e=ft(),this.name=t,this.message=e}function Oi(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,s)=>s.indexOf(n)===r).join(`
`)}function An(t,e,n,r){this._e=ft(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Oi(t,e)}function Ut(t,e){this._e=ft(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Oi(t,e)}yt(gt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+gr(this._e,2))}},toString:function(){return this.name+": "+this.message}}),yt(An).from(gt),yt(Ut).from(gt);var as=os.reduce((t,e)=>(t[e]=e+"Error",t),{});const ya=gt;var B=os.reduce((t,e)=>{var n=e+"Error";function r(s,i){this._e=ft(),this.name=n,s?typeof s=="string"?(this.message=`${s}${i?`
 `+i:""}`,this.inner=i||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=_a[e]||n,this.inner=null)}return yt(r).from(ya),t[e]=r,t},{});B.Syntax=SyntaxError,B.Type=TypeError,B.Range=RangeError;var Ds=Ri.reduce((t,e)=>(t[e+"Error"]=B[e],t),{}),Sn=os.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=B[e]),t),{});function q(){}function Wt(t){return t}function ga(t,e){return t==null||t===Wt?e:function(n){return e(t(n))}}function at(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function va(t,e){return t===q?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?at(r,this.onsuccess):r),s&&(this.onerror=this.onerror?at(s,this.onerror):s),i!==void 0?i:n}}function ba(t,e){return t===q?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?at(n,this.onsuccess):n),r&&(this.onerror=this.onerror?at(r,this.onerror):r)}}function wa(t,e){return t===q?e:function(n){var r=t.apply(this,arguments);ce(n,r);var s=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?at(s,this.onsuccess):s),i&&(this.onerror=this.onerror?at(i,this.onerror):i),r===void 0?o===void 0?void 0:o:ce(r,o)}}function Ea(t,e){return t===q?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function cs(t,e){return t===q?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return n.then(function(){return e.apply(r,i)})}return e.apply(this,arguments)}}Sn.ModifyError=An,Sn.DexieError=gt,Sn.BulkError=Ut;var Vt={};const Di=100,[vr,In,br]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Gt(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Gt(e),t]})(),Ni=In&&In.then,kn=vr&&vr.constructor,us=!!br;var wr=!1,Sa=br?()=>{br.then(an)}:V.setImmediate?setImmediate.bind(null,an):V.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{an(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(an,0)},Kt=function(t,e){Mt.push([t,e]),Pn&&(Sa(),Pn=!1)},Er=!0,Pn=!0,st=[],xn=[],Sr=null,kr=Wt,vt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Is,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{Is(t[0],t[1])}catch{}})}},C=vt,Mt=[],it=0,Tn=[];function I(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=q,this._lib=!1;var e=this._PSD=C;if(Ee&&(this._stackHolder=ft(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Vt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Tr(this,this._value))}this._state=null,this._value=null,++e.ref,Ii(this,t)}const xr={get:function(){var t=C,e=Cn;function n(r,s){var i=!t.global&&(t!==C||e!==Cn);const o=i&&!Me();var a=new I((c,l)=>{ls(this,new Ai(Mn(r,t,i,o),Mn(s,t,i,o),c,l,t))});return Ee&&Mi(a,this),a}return n.prototype=Vt,n},set:function(t){Pe(this,"then",t&&t.prototype===Vt?xr:{get:function(){return t},set:xr.set})}};function Ai(t,e,n,r,s){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=s}function Ii(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&tn();n&&typeof n.then=="function"?Ii(t,(s,i)=>{n instanceof I?n._then(s,i):n.then(s,i)}):(t._state=!0,t._value=n,Pi(t)),r&&nn()}},Tr.bind(null,t))}catch(n){Tr(t,n)}}function Tr(t,e){if(xn.push(e),t._state===null){var n=t._lib&&tn();e=kr(e),t._state=!1,t._value=e,Ee&&e!==null&&typeof e=="object"&&!e._promise&&function(r,s,i){try{r.apply(null,i)}catch(o){s&&s(o)}}(()=>{var r=ss(e,"stack");e._promise=t,Pe(e,"stack",{get:()=>wr?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){st.some(s=>s._value===r._value)||st.push(r)}(t),Pi(t),n&&nn()}}function Pi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)ls(t,e[n]);var s=t._PSD;--s.ref||s.finalize(),it===0&&(++it,Kt(()=>{--it==0&&ds()},[]))}function ls(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++it,Kt(ka,[n,t,e])}else t._listeners.push(e)}function ka(t,e,n){try{Sr=e;var r,s=e._value;e._state?r=t(s):(xn.length&&(xn=[]),r=t(s),xn.indexOf(s)===-1&&function(i){for(var o=st.length;o;)if(st[--o]._value===i._value)return void st.splice(o,1)}(e)),n.resolve(r)}catch(i){n.reject(i)}finally{Sr=null,--it==0&&ds(),--n.psd.ref||n.psd.finalize()}}function Ci(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var s,i,o=t._value;o!=null?(s=o.name||"Error",i=o.message||o,r=gr(o,0)):(s=o,i=""),e.push(s+(i?": "+i:"")+r)}return Ee&&((r=gr(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Ci(t._prev,e,n)),e}function Mi(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function an(){tn()&&nn()}function tn(){var t=Er;return Er=!1,Pn=!1,t}function nn(){var t,e,n;do for(;Mt.length>0;)for(t=Mt,Mt=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(Mt.length>0);Er=!0,Pn=!0}function ds(){var t=st;st=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=Tn.slice(0),n=e.length;n;)e[--n]()}function cn(t){return new I(Vt,!1,t)}function z(t,e){var n=C;return function(){var r=tn(),s=C;try{return Ve(n,!0),t.apply(this,arguments)}catch(i){e&&e(i)}finally{Ve(s,!1),r&&nn()}}}wt(I.prototype,{then:xr,_then:function(t,e){ls(this,new Ai(null,null,t,e,C))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):cn(r)):this.then(null,r=>r&&r.name===e?n(r):cn(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),cn(e)))},stack:{get:function(){if(this._stack)return this._stack;try{wr=!0;var t=Ci(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{wr=!1}}},timeout:function(t,e){return t<1/0?new I((n,r)=>{var s=setTimeout(()=>r(new B.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Pe(I.prototype,Symbol.toStringTag,"Dexie.Promise"),vt.env=Bi(),wt(I,{all:function(){var t=Ae.apply(null,arguments).map(un);return new I(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((s,i)=>I.resolve(s).then(o=>{t[i]=o,--r||e(t)},n))})},resolve:t=>{if(t instanceof I)return t;if(t&&typeof t.then=="function")return new I((n,r)=>{t.then(n,r)});var e=new I(Vt,!0,t);return Mi(e,Sr),e},reject:cn,race:function(){var t=Ae.apply(null,arguments).map(un);return new I((e,n)=>{t.map(r=>I.resolve(r).then(e,n))})},PSD:{get:()=>C,set:t=>C=t},totalEchoes:{get:()=>Cn},newPSD:We,usePSD:Tt,scheduler:{get:()=>Kt,set:t=>{Kt=t}},rejectionMapper:{get:()=>kr,set:t=>{kr=t}},follow:(t,e)=>new I((n,r)=>We((s,i)=>{var o=C;o.unhandleds=[],o.onunhandled=i,o.finalize=at(function(){(function(a){function c(){a(),Tn.splice(Tn.indexOf(c),1)}Tn.push(c),++it,Kt(()=>{--it==0&&ds()},[])})(()=>{this.unhandleds.length===0?s():i(this.unhandleds[0])})},o.finalize),t()},e,n,r))}),kn&&(kn.allSettled&&Pe(I,"allSettled",function(){const t=Ae.apply(null,arguments).map(un);return new I(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((s,i)=>I.resolve(s).then(o=>r[i]={status:"fulfilled",value:o},o=>r[i]={status:"rejected",reason:o}).then(()=>--n||e(r)))})}),kn.any&&typeof AggregateError<"u"&&Pe(I,"any",function(){const t=Ae.apply(null,arguments).map(un);return new I((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const s=new Array(r);t.forEach((i,o)=>I.resolve(i).then(a=>e(a),a=>{s[o]=a,--r||n(new AggregateError(s))}))})}));const se={awaits:0,echoes:0,id:0};var xa=0,Rn=[],rr=0,Cn=0,Ta=0;function We(t,e,n,r){var s=C,i=Object.create(s);i.parent=s,i.ref=0,i.global=!1,i.id=++Ta;var o=vt.env;i.env=us?{Promise:I,PromiseProp:{value:I,configurable:!0,writable:!0},all:I.all,race:I.race,allSettled:I.allSettled,any:I.any,resolve:I.resolve,reject:I.reject,nthen:Ns(o.nthen,i),gthen:Ns(o.gthen,i)}:{},e&&ce(i,e),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Tt(i,t,n,r);return i.ref===0&&i.finalize(),a}function xt(){return se.id||(se.id=++xa),++se.awaits,se.echoes+=Di,se.id}function Me(){return!!se.awaits&&(--se.awaits==0&&(se.id=0),se.echoes=se.awaits*Di,!0)}function un(t){return se.echoes&&t&&t.constructor===kn?(xt(),t.then(e=>(Me(),e),e=>(Me(),Q(e)))):t}function Ra(t){++Cn,se.echoes&&--se.echoes!=0||(se.echoes=se.id=0),Rn.push(C),Ve(t,!0)}function Oa(){var t=Rn[Rn.length-1];Rn.pop(),Ve(t,!1)}function Ve(t,e){var n=C;if((e?!se.echoes||rr++&&t===C:!rr||--rr&&t===C)||$i(e?Ra.bind(null,t):Oa),t!==C&&(C=t,n===vt&&(vt.env=Bi()),us)){var r=vt.env.Promise,s=t.env;In.then=s.nthen,r.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(V,"Promise",s.PromiseProp),r.all=s.all,r.race=s.race,r.resolve=s.resolve,r.reject=s.reject,s.allSettled&&(r.allSettled=s.allSettled),s.any&&(r.any=s.any))}}function Bi(){var t=V.Promise;return us?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(V,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:In.then,gthen:t.prototype.then}:{}}function Tt(t,e,n,r,s){var i=C;try{return Ve(t,!0),e(n,r,s)}finally{Ve(i,!1)}}function $i(t){Ni.call(vr,t)}function Mn(t,e,n,r){return typeof t!="function"?t:function(){var s=C;n&&xt(),Ve(e,!0);try{return t.apply(this,arguments)}finally{Ve(s,!1),r&&$i(Me)}}}function Ns(t,e){return function(n,r){return t.call(this,Mn(n,e),Mn(r,e))}}(""+Ni).indexOf("[native code]")===-1&&(xt=Me=q);const As="unhandledrejection";function Is(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,s={promise:e,reason:t};if(V.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(As,!0,!0),ce(r,s)):V.CustomEvent&&ce(r=new CustomEvent(As,{detail:s}),s),r&&V.dispatchEvent&&(dispatchEvent(r),!V.PromiseRejectionEvent&&V.onunhandledrejection))try{V.onunhandledrejection(r)}catch{}Ee&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Q=I.reject;function Rr(t,e,n,r){if(t.idbdb&&(t._state.openComplete||C.letThrough||t._vip)){var s=t._createTransaction(e,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(i){return i.name===as.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Rr(t,e,n,r))):Q(i)}return s._promise(e,(i,o)=>We(()=>(C.trans=s,r(i,o,s)))).then(i=>s._completion.then(()=>i))}if(t._state.openComplete)return Q(new B.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Q(new B.DatabaseClosed);t.open().catch(q)}return t._state.dbReadyPromise.then(()=>Rr(t,e,n,r))}const Ps="3.2.4",rt=String.fromCharCode(65535),Or=-1/0,Se="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ji="String expected.",Ft=[],Fn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Da=Fn,Na=Fn,Ui=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),Ln="__dbnames",sr="readonly",ir="readwrite";function ct(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Ki={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ln(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=en(e))[t],e)}class Aa{_trans(e,n,r){const s=this._tx||C.trans,i=this.name;function o(c,l,d){if(!d.schema[i])throw new B.NotFound("Table "+i+" not part of transaction");return n(d.idbtrans,d)}const a=tn();try{return s&&s.db===this.db?s===C.trans?s._promise(e,o,r):We(()=>s._promise(e,o,r),{trans:s,transless:C.transless||C}):Rr(this.db,e,[this.name],o)}finally{a&&nn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(s=>this.hook.reading.fire(s))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(ie(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=J(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(l=>l.compound&&n.every(d=>l.keyPath.indexOf(d)>=0)&&l.keyPath.every(d=>n.indexOf(d)>=0))[0];if(r&&this.db._maxKey!==rt)return this.where(r.name).equals(r.keyPath.map(l=>e[l]));!r&&Ee&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,i=this.db._deps.indexedDB;function o(l,d){try{return i.cmp(l,d)===0}catch{return!1}}const[a,c]=n.reduce(([l,d],u)=>{const f=s[u],h=e[u];return[l||f,l||!f?ct(d,f&&f.multi?g=>{const m=Ce(g,u);return ie(m)&&m.some(v=>o(h,v))}:g=>o(h,Ce(g,u))):d]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,ie(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const s=Object.create(e.prototype);for(var i in r)if(he(r,i))try{s[i]=r[i]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){ce(this,e)})}add(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let i=e;return s&&r&&(i=ln(s)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:n!=null?[n]:null,values:[i]})).then(o=>o.numFailures?I.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{ye(e,s,o)}catch{}return o})}update(e,n){if(typeof e!="object"||ie(e))return this.where(":id").equals(e).modify(n);{const r=Ce(e,this.schema.primKey.keyPath);if(r===void 0)return Q(new B.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?J(n).forEach(s=>{ye(e,s,n[s])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let i=e;return s&&r&&(i=ln(s)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[i],keys:n!=null?[n]:null})).then(o=>o.numFailures?I.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{ye(e,s,o)}catch{}return o})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?I.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Ki})).then(e=>e.numFailures?I.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(s=>this.hook.reading.fire(s))))}bulkAdd(e,n,r){const s=Array.isArray(n)?n:void 0,i=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:c}=this.schema.primKey;if(c&&s)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");const l=e.length;let d=c&&a?e.map(ln(c)):e;return this.core.mutate({trans:o,type:"add",keys:s,values:d,wantResults:i}).then(({numFailures:u,results:f,lastResult:h,failures:g})=>{if(u===0)return i?f:h;throw new Ut(`${this.name}.bulkAdd(): ${u} of ${l} operations failed`,g)})})}bulkPut(e,n,r){const s=Array.isArray(n)?n:void 0,i=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:c}=this.schema.primKey;if(c&&s)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");const l=e.length;let d=c&&a?e.map(ln(c)):e;return this.core.mutate({trans:o,type:"put",keys:s,values:d,wantResults:i}).then(({numFailures:u,results:f,lastResult:h,failures:g})=>{if(u===0)return i?f:h;throw new Ut(`${this.name}.bulkPut(): ${u} of ${l} operations failed`,g)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:s,failures:i})=>{if(r===0)return s;throw new Ut(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,i)})}}function Lt(t){var e={},n=function(o,a){if(a){for(var c=arguments.length,l=new Array(c-1);--c;)l[c-1]=arguments[c];return e[o].subscribe.apply(null,l),t}if(typeof o=="string")return e[o]};n.addEventType=i;for(var r=1,s=arguments.length;r<s;++r)i(arguments[r]);return n;function i(o,a,c){if(typeof o!="object"){var l;a||(a=Ea),c||(c=q);var d={subscribers:[],fire:c,subscribe:function(u){d.subscribers.indexOf(u)===-1&&(d.subscribers.push(u),d.fire=a(d.fire,u))},unsubscribe:function(u){d.subscribers=d.subscribers.filter(function(f){return f!==u}),d.fire=d.subscribers.reduce(a,c)}};return e[o]=n[o]=d,d}J(l=o).forEach(function(u){var f=l[u];if(ie(f))i(u,l[u][0],l[u][1]);else{if(f!=="asap")throw new B.InvalidArgument("Invalid event config");var h=i(u,Wt,function(){for(var g=arguments.length,m=new Array(g);g--;)m[g]=arguments[g];h.subscribers.forEach(function(v){bi(function(){v.apply(null,m)})})})}})}}function At(t,e){return yt(e).from({prototype:t}),e}function pt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function or(t,e){t.filter=ct(t.filter,e)}function ar(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>ct(r(),e()):e,t.justLimit=n&&!r}function On(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new B.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Cs(t,e,n){const r=On(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function dn(t,e,n,r){const s=t.replayFilter?ct(t.filter,t.replayFilter()):t.filter;if(t.or){const i={},o=(a,c,l)=>{if(!s||s(c,l,f=>c.stop(f),f=>c.fail(f))){var d=c.primaryKey,u=""+d;u==="[object ArrayBuffer]"&&(u=""+new Uint8Array(d)),he(i,u)||(i[u]=!0,e(a,c,l))}};return Promise.all([t.or._iterate(o,n),Ms(Cs(t,r,n),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}return Ms(Cs(t,r,n),ct(t.algorithm,s),e,!t.keysOnly&&t.valueMapper)}function Ms(t,e,n,r){var s=z(r?(i,o,a)=>n(r(i),o,a):n);return t.then(i=>{if(i)return i.start(()=>{var o=()=>i.continue();e&&!e(i,a=>o=a,a=>{i.stop(a),o=q},a=>{i.fail(a),o=q})||s(i.value,i,a=>o=a),o()})})}function ae(t,e){try{const n=Bs(t),r=Bs(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(s,i){const o=s.length,a=i.length,c=o<a?o:a;for(let l=0;l<c;++l)if(s[l]!==i[l])return s[l]<i[l]?-1:1;return o===a?0:o<a?-1:1}($s(t),$s(e));case"Array":return function(s,i){const o=s.length,a=i.length,c=o<a?o:a;for(let l=0;l<c;++l){const d=ae(s[l],i[l]);if(d!==0)return d}return o===a?0:o<a?-1:1}(t,e)}}catch{}return NaN}function Bs(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=_r(t);return n==="ArrayBuffer"?"binary":n}function $s(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Ia{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Q.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Q.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=ct(n.algorithm,e)}_iterate(e,n){return dn(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&ce(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>dn(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,s=r.table.core;if(pt(r,!0))return s.count({trans:n,query:{index:On(r,s.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var i=0;return dn(r,()=>(++i,!1),n,s).then(()=>i)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),s=r[0],i=r.length-1;function o(l,d){return d?o(l[r[d]],d-1):l[s]}var a=this._ctx.dir==="next"?1:-1;function c(l,d){var u=o(l,i),f=o(d,i);return u<f?-a:u>f?a:0}return this.toArray(function(l){return l.sort(c)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&pt(r,!0)&&r.limit>0){const{valueMapper:s}=r,i=On(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then(({result:o})=>s?o.map(s):o)}{const s=[];return dn(r,i=>s.push(i),n,r.table.core).then(()=>s)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,pt(n)?ar(n,()=>{var r=e;return(s,i)=>r===0||(r===1?(--r,!1):(i(()=>{s.advance(r),r=0}),!1))}):ar(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),ar(this._ctx,()=>{var n=e;return function(r,s,i){return--n<=0&&s(i),n>=0}},!0),this}until(e,n){return or(this._ctx,function(r,s,i){return!e(r.value)||(s(i),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return or(this._ctx,function(s){return e(s.value)}),n=this._ctx,r=e,n.isMatch=ct(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.key,s)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.primaryKey,s)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,i){r.push(i.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&pt(n,!0)&&n.limit>0)return this._read(s=>{var i=On(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:i,range:n.range}})}).then(({result:s})=>s).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,i){r.push(i.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return or(this._ctx,function(s){var i=s.primaryKey.toString(),o=he(r,i);return r[i]=!0,!o}),this}modify(e){var n=this._ctx;return this._write(r=>{var s;if(typeof e=="function")s=e;else{var i=J(e),o=i.length;s=function(m){for(var v=!1,y=0;y<o;++y){var _=i[y],w=e[_];Ce(m,_)!==w&&(ye(m,_,w),v=!0)}return v}}const a=n.table.core,{outbound:c,extractKey:l}=a.schema.primaryKey,d=this.db._options.modifyChunkSize||200,u=[];let f=0;const h=[],g=(m,v)=>{const{failures:y,numFailures:_}=v;f+=m-_;for(let w of J(y))u.push(y[w])};return this.clone().primaryKeys().then(m=>{const v=y=>{const _=Math.min(d,m.length-y);return a.getMany({trans:r,keys:m.slice(y,y+_),cache:"immutable"}).then(w=>{const A=[],T=[],k=c?[]:null,S=[];for(let b=0;b<_;++b){const P=w[b],R={value:en(P),primKey:m[y+b]};s.call(R,R.value,R)!==!1&&(R.value==null?S.push(m[y+b]):c||ae(l(P),l(R.value))===0?(T.push(R.value),c&&k.push(m[y+b])):(S.push(m[y+b]),A.push(R.value)))}const j=pt(n)&&n.limit===1/0&&(typeof e!="function"||e===cr)&&{index:n.index,range:n.range};return Promise.resolve(A.length>0&&a.mutate({trans:r,type:"add",values:A}).then(b=>{for(let P in b.failures)S.splice(parseInt(P),1);g(A.length,b)})).then(()=>(T.length>0||j&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:k,values:T,criteria:j,changeSpec:typeof e!="function"&&e}).then(b=>g(T.length,b))).then(()=>(S.length>0||j&&e===cr)&&a.mutate({trans:r,type:"delete",keys:S,criteria:j}).then(b=>g(S.length,b))).then(()=>m.length>y+_&&v(y+d))})};return v(0).then(()=>{if(u.length>0)throw new An("Error modifying one or more objects",u,f,h);return m.length})})})}delete(){var e=this._ctx,n=e.range;return pt(e)&&(e.isPrimKey&&!Na||n.type===3)?this._write(r=>{const{primaryKey:s}=e.table.core.schema,i=n;return e.table.core.count({trans:r,query:{index:s,range:i}}).then(o=>e.table.core.mutate({trans:r,type:"deleteRange",range:i}).then(({failures:a,lastResult:c,results:l,numFailures:d})=>{if(d)throw new An("Could not delete some values",Object.keys(a).map(u=>a[u]),o-d);return o-d}))}):this.modify(cr)}}const cr=(t,e)=>e.value=null;function Pa(t,e){return t<e?-1:t===e?0:1}function Ca(t,e){return t>e?-1:t===e?0:1}function de(t,e,n){var r=t instanceof Li?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function mt(t){return new t.Collection(t,()=>Fi("")).limit(0)}function Ma(t,e,n,r,s,i){for(var o=Math.min(t.length,r.length),a=-1,c=0;c<o;++c){var l=e[c];if(l!==r[c])return s(t[c],n[c])<0?t.substr(0,c)+n[c]+n.substr(c+1):s(t[c],r[c])<0?t.substr(0,c)+r[c]+n.substr(c+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;s(t[c],l)<0&&(a=c)}return o<r.length&&i==="next"?t+n.substr(t.length):o<t.length&&i==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function fn(t,e,n,r){var s,i,o,a,c,l,d,u=n.length;if(!n.every(m=>typeof m=="string"))return de(t,ji);function f(m){s=function(y){return y==="next"?_=>_.toUpperCase():_=>_.toLowerCase()}(m),i=function(y){return y==="next"?_=>_.toLowerCase():_=>_.toUpperCase()}(m),o=m==="next"?Pa:Ca;var v=n.map(function(y){return{lower:i(y),upper:s(y)}}).sort(function(y,_){return o(y.lower,_.lower)});a=v.map(function(y){return y.upper}),c=v.map(function(y){return y.lower}),l=m,d=m==="next"?"":r}f("next");var h=new t.Collection(t,()=>$e(a[0],c[u-1]+r));h._ondirectionchange=function(m){f(m)};var g=0;return h._addAlgorithm(function(m,v,y){var _=m.key;if(typeof _!="string")return!1;var w=i(_);if(e(w,c,g))return!0;for(var A=null,T=g;T<u;++T){var k=Ma(_,w,a[T],c[T],o,l);k===null&&A===null?g=T+1:(A===null||o(A,k)>0)&&(A=k)}return v(A!==null?function(){m.continue(A+d)}:y),!1}),h}function $e(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Fi(t){return{type:1,lower:t,upper:t}}class Li{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,s){r=r!==!1,s=s===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||s)&&(!r||!s)?mt(this):new this.Collection(this,()=>$e(e,n,!r,!s))}catch{return de(this,Se)}}equals(e){return e==null?de(this,Se):new this.Collection(this,()=>Fi(e))}above(e){return e==null?de(this,Se):new this.Collection(this,()=>$e(e,void 0,!0))}aboveOrEqual(e){return e==null?de(this,Se):new this.Collection(this,()=>$e(e,void 0,!1))}below(e){return e==null?de(this,Se):new this.Collection(this,()=>$e(void 0,e,!1,!0))}belowOrEqual(e){return e==null?de(this,Se):new this.Collection(this,()=>$e(void 0,e))}startsWith(e){return typeof e!="string"?de(this,ji):this.between(e,e+rt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):fn(this,(n,r)=>n.indexOf(r[0])===0,[e],rt)}equalsIgnoreCase(e){return fn(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=Ae.apply(_t,arguments);return e.length===0?mt(this):fn(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=Ae.apply(_t,arguments);return e.length===0?mt(this):fn(this,(n,r)=>r.some(s=>n.indexOf(s)===0),e,rt)}anyOf(){const e=Ae.apply(_t,arguments);let n=this._cmp;try{e.sort(n)}catch{return de(this,Se)}if(e.length===0)return mt(this);const r=new this.Collection(this,()=>$e(e[0],e[e.length-1]));r._ondirectionchange=i=>{n=i==="next"?this._ascending:this._descending,e.sort(n)};let s=0;return r._addAlgorithm((i,o,a)=>{const c=i.key;for(;n(c,e[s])>0;)if(++s,s===e.length)return o(a),!1;return n(c,e[s])===0||(o(()=>{i.continue(e[s])}),!1)}),r}notEqual(e){return this.inAnyRange([[Or,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Ae.apply(_t,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return de(this,Se)}const n=e.reduce((r,s)=>r?r.concat([[r[r.length-1][1],s]]):[[Or,s]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,s=this._ascending,i=this._descending,o=this._min,a=this._max;if(e.length===0)return mt(this);if(!e.every(_=>_[0]!==void 0&&_[1]!==void 0&&s(_[0],_[1])<=0))return de(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);const c=!n||n.includeLowers!==!1,l=n&&n.includeUppers===!0;let d,u=s;function f(_,w){return u(_[0],w[0])}try{d=e.reduce(function(_,w){let A=0,T=_.length;for(;A<T;++A){const k=_[A];if(r(w[0],k[1])<0&&r(w[1],k[0])>0){k[0]=o(k[0],w[0]),k[1]=a(k[1],w[1]);break}}return A===T&&_.push(w),_},[]),d.sort(f)}catch{return de(this,Se)}let h=0;const g=l?_=>s(_,d[h][1])>0:_=>s(_,d[h][1])>=0,m=c?_=>i(_,d[h][0])>0:_=>i(_,d[h][0])>=0;let v=g;const y=new this.Collection(this,()=>$e(d[0][0],d[d.length-1][1],!c,!l));return y._ondirectionchange=_=>{_==="next"?(v=g,u=s):(v=m,u=i),d.sort(f)},y._addAlgorithm((_,w,A)=>{for(var T=_.key;v(T);)if(++h,h===d.length)return w(A),!1;return!!function(k){return!g(k)&&!m(k)}(T)||(this._cmp(T,d[h][1])===0||this._cmp(T,d[h][0])===0||w(()=>{u===s?_.continue(d[h][0]):_.continue(d[h][1])}),!1)}),y}startsWithAnyOf(){const e=Ae.apply(_t,arguments);return e.every(n=>typeof n=="string")?e.length===0?mt(this):this.inAnyRange(e.map(n=>[n,n+rt])):de(this,"startsWithAnyOf() only works with strings")}}function be(t){return z(function(e){return zt(e),t(e.target.error),!1})}function zt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const Xt="storagemutated",Le="x-storagemutated-1",ze=Lt(null,Xt);class Ba{_lock(){return Ct(!C.global),++this._reculock,this._reculock!==1||C.global||(C.lockOwnerFor=this),this}_unlock(){if(Ct(!C.global),--this._reculock==0)for(C.global||(C.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Tt(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&C.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(Ct(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new B.DatabaseClosed(r);case"MissingAPIError":throw new B.MissingAPI(r.message,r);default:throw new B.OpenFailed(r)}if(!this.active)throw new B.TransactionInactive;return Ct(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=z(s=>{zt(s),this._reject(e.error)}),e.onabort=z(s=>{zt(s),this.active&&this._reject(new B.Abort(e.error)),this.active=!1,this.on("abort").fire(s)}),e.oncomplete=z(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&ze.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Q(new B.ReadOnly("Transaction is readonly"));if(!this.active)return Q(new B.TransactionInactive);if(this._locked())return new I((i,o)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(i,o)},C])});if(r)return We(()=>{var i=new I((o,a)=>{this._lock();const c=n(o,a,this);c&&c.then&&c.then(o,a)});return i.finally(()=>this._unlock()),i._lib=!0,i});var s=new I((i,o)=>{var a=n(i,o,this);a&&a.then&&a.then(i,o)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=I.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=o)})()}var i=n._waitingFor;return new I((o,a)=>{r.then(c=>n._waitingQueue.push(z(o.bind(null,c))),c=>n._waitingQueue.push(z(a.bind(null,c)))).finally(()=>{n._waitingFor===i&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(he(n,e))return n[e];const r=this.schema[e];if(!r)throw new B.NotFound("Table "+e+" not part of transaction");const s=new this.db.Table(e,r,this);return s.core=this.db.core.table(e),n[e]=s,s}}function Dr(t,e,n,r,s,i,o){return{name:t,keyPath:e,unique:n,multi:r,auto:s,compound:i,src:(n&&!o?"&":"")+(r?"*":"")+(s?"++":"")+Yi(e)}}function Yi(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function qi(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:wi(n,r=>[r.name,r])}}let Jt=t=>{try{return t.only([[]]),Jt=()=>[[]],[[]]}catch{return Jt=()=>rt,rt}};function Nr(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>Ce(r,e)}(t):e=>Ce(e,t)}function js(t){return[].slice.call(t)}let $a=0;function Yt(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function ja(t,e,n){function r(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:l,upper:d,lowerOpen:u,upperOpen:f}=c;return l===void 0?d===void 0?null:e.upperBound(d,!!f):d===void 0?e.lowerBound(l,!!u):e.bound(l,d,!!u,!!f)}const{schema:s,hasGetAll:i}=function(c,l){const d=js(c.objectStoreNames);return{schema:{name:c.name,tables:d.map(u=>l.objectStore(u)).map(u=>{const{keyPath:f,autoIncrement:h}=u,g=ie(f),m=f==null,v={},y={name:u.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:m,compound:g,keyPath:f,autoIncrement:h,unique:!0,extractKey:Nr(f)},indexes:js(u.indexNames).map(_=>u.index(_)).map(_=>{const{name:w,unique:A,multiEntry:T,keyPath:k}=_,S={name:w,compound:ie(k),keyPath:k,unique:A,multiEntry:T,extractKey:Nr(k)};return v[Yt(k)]=S,S}),getIndexByKeyPath:_=>v[Yt(_)]};return v[":id"]=y.primaryKey,f!=null&&(v[Yt(f)]=y.primaryKey),y})},hasGetAll:d.length>0&&"getAll"in l.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),o=s.tables.map(c=>function(l){const d=l.name;return{name:d,schema:l,mutate:function({trans:u,type:f,keys:h,values:g,range:m}){return new Promise((v,y)=>{v=z(v);const _=u.objectStore(d),w=_.keyPath==null,A=f==="put"||f==="add";if(!A&&f!=="delete"&&f!=="deleteRange")throw new Error("Invalid operation type: "+f);const{length:T}=h||g||{length:1};if(h&&g&&h.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(T===0)return v({numFailures:0,failures:{},results:[],lastResult:void 0});let k;const S=[],j=[];let b=0;const P=Y=>{++b,zt(Y)};if(f==="deleteRange"){if(m.type===4)return v({numFailures:b,failures:j,results:[],lastResult:void 0});m.type===3?S.push(k=_.clear()):S.push(k=_.delete(r(m)))}else{const[Y,L]=A?w?[g,h]:[g,null]:[h,null];if(A)for(let D=0;D<T;++D)S.push(k=L&&L[D]!==void 0?_[f](Y[D],L[D]):_[f](Y[D])),k.onerror=P;else for(let D=0;D<T;++D)S.push(k=_[f](Y[D])),k.onerror=P}const R=Y=>{const L=Y.target.result;S.forEach((D,O)=>D.error!=null&&(j[O]=D.error)),v({numFailures:b,failures:j,results:f==="delete"?h:S.map(D=>D.result),lastResult:L})};k.onerror=Y=>{P(Y),R(Y)},k.onsuccess=R})},getMany:({trans:u,keys:f})=>new Promise((h,g)=>{h=z(h);const m=u.objectStore(d),v=f.length,y=new Array(v);let _,w=0,A=0;const T=S=>{const j=S.target;y[j._pos]=j.result,++A===w&&h(y)},k=be(g);for(let S=0;S<v;++S)f[S]!=null&&(_=m.get(f[S]),_._pos=S,_.onsuccess=T,_.onerror=k,++w);w===0&&h(y)}),get:({trans:u,key:f})=>new Promise((h,g)=>{h=z(h);const m=u.objectStore(d).get(f);m.onsuccess=v=>h(v.target.result),m.onerror=be(g)}),query:function(u){return f=>new Promise((h,g)=>{h=z(h);const{trans:m,values:v,limit:y,query:_}=f,w=y===1/0?void 0:y,{index:A,range:T}=_,k=m.objectStore(d),S=A.isPrimaryKey?k:k.index(A.name),j=r(T);if(y===0)return h({result:[]});if(u){const b=v?S.getAll(j,w):S.getAllKeys(j,w);b.onsuccess=P=>h({result:P.target.result}),b.onerror=be(g)}else{let b=0;const P=v||!("openKeyCursor"in S)?S.openCursor(j):S.openKeyCursor(j),R=[];P.onsuccess=Y=>{const L=P.result;return L?(R.push(v?L.value:L.primaryKey),++b===y?h({result:R}):void L.continue()):h({result:R})},P.onerror=be(g)}})}(i),openCursor:function({trans:u,values:f,query:h,reverse:g,unique:m}){return new Promise((v,y)=>{v=z(v);const{index:_,range:w}=h,A=u.objectStore(d),T=_.isPrimaryKey?A:A.index(_.name),k=g?m?"prevunique":"prev":m?"nextunique":"next",S=f||!("openKeyCursor"in T)?T.openCursor(r(w),k):T.openKeyCursor(r(w),k);S.onerror=be(y),S.onsuccess=z(j=>{const b=S.result;if(!b)return void v(null);b.___id=++$a,b.done=!1;const P=b.continue.bind(b);let R=b.continuePrimaryKey;R&&(R=R.bind(b));const Y=b.advance.bind(b),L=()=>{throw new Error("Cursor not stopped")};b.trans=u,b.stop=b.continue=b.continuePrimaryKey=b.advance=()=>{throw new Error("Cursor not started")},b.fail=z(y),b.next=function(){let D=1;return this.start(()=>D--?this.continue():this.stop()).then(()=>this)},b.start=D=>{const O=new Promise((N,x)=>{N=z(N),S.onerror=be(x),b.fail=x,b.stop=M=>{b.stop=b.continue=b.continuePrimaryKey=b.advance=L,N(M)}}),E=()=>{if(S.result)try{D()}catch(N){b.fail(N)}else b.done=!0,b.start=()=>{throw new Error("Cursor behind last entry")},b.stop()};return S.onsuccess=z(N=>{S.onsuccess=E,E()}),b.continue=P,b.continuePrimaryKey=R,b.advance=Y,E(),O},v(b)},y)})},count({query:u,trans:f}){const{index:h,range:g}=u;return new Promise((m,v)=>{const y=f.objectStore(d),_=h.isPrimaryKey?y:y.index(h.name),w=r(g),A=w?_.count(w):_.count();A.onsuccess=z(T=>m(T.target.result)),A.onerror=be(v)})}}}(c)),a={};return o.forEach(c=>a[c.name]=c),{stack:"dbcore",transaction:t.transaction.bind(t),table(c){if(!a[c])throw new Error(`Table '${c}' not found`);return a[c]},MIN_KEY:-1/0,MAX_KEY:Jt(e),schema:s}}function Ar({_novip:t},e){const n=e.db,r=function(s,i,{IDBKeyRange:o,indexedDB:a},c){return{dbcore:function(d,u){return u.reduce((f,{create:h})=>({...f,...h(f)}),d)}(ja(i,o,c),s.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(s=>{const i=s.name;t.core.schema.tables.some(o=>o.name===i)&&(s.core=t.core.table(i),t[i]instanceof t.Table&&(t[i].core=s.core))})}function Bn({_novip:t},e,n,r){n.forEach(s=>{const i=r[s];e.forEach(o=>{const a=ss(o,s);(!a||"value"in a&&a.value===void 0)&&(o===t.Transaction.prototype||o instanceof t.Transaction?Pe(o,s,{get(){return this.table(s)},set(c){gi(this,s,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new t.Table(s,i))})})}function Ir({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function Ua(t,e){return t._cfg.version-e._cfg.version}function Ka(t,e,n,r){const s=t._dbSchema,i=t._createTransaction("readwrite",t._storeNames,s);i.create(n),i._completion.catch(r);const o=i._reject.bind(i),a=C.transless||C;We(()=>{C.trans=i,C.transless=a,e===0?(J(s).forEach(c=>{ur(n,c,s[c].primKey,s[c].indexes)}),Ar(t,n),I.follow(()=>t.on.populate.fire(i)).catch(o)):function({_novip:c},l,d,u){const f=[],h=c._versions;let g=c._dbSchema=Cr(c,c.idbdb,u),m=!1;const v=h.filter(_=>_._cfg.version>=l);function y(){return f.length?I.resolve(f.shift()(d.idbtrans)).then(y):I.resolve()}return v.forEach(_=>{f.push(()=>{const w=g,A=_._cfg.dbschema;Mr(c,w,u),Mr(c,A,u),g=c._dbSchema=A;const T=Hi(w,A);T.add.forEach(S=>{ur(u,S[0],S[1].primKey,S[1].indexes)}),T.change.forEach(S=>{if(S.recreate)throw new B.Upgrade("Not yet support for changing primary key");{const j=u.objectStore(S.name);S.add.forEach(b=>Pr(j,b)),S.change.forEach(b=>{j.deleteIndex(b.name),Pr(j,b)}),S.del.forEach(b=>j.deleteIndex(b))}});const k=_._cfg.contentUpgrade;if(k&&_._cfg.version>l){Ar(c,u),d._memoizedTables={},m=!0;let S=Ei(A);T.del.forEach(R=>{S[R]=w[R]}),Ir(c,[c.Transaction.prototype]),Bn(c,[c.Transaction.prototype],J(S),S),d.schema=S;const j=is(k);let b;j&&xt();const P=I.follow(()=>{if(b=k(d),b&&j){var R=Me.bind(null,null);b.then(R,R)}});return b&&typeof b.then=="function"?I.resolve(b):P.then(()=>b)}}),f.push(w=>{(!m||!Da)&&function(A,T){[].slice.call(T.db.objectStoreNames).forEach(k=>A[k]==null&&T.db.deleteObjectStore(k))}(_._cfg.dbschema,w),Ir(c,[c.Transaction.prototype]),Bn(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),d.schema=c._dbSchema})}),y().then(()=>{var _,w;w=u,J(_=g).forEach(A=>{w.db.objectStoreNames.contains(A)||ur(w,A,_[A].primKey,_[A].indexes)})})}(t,e,i,n).catch(o)})}function Hi(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const s=t[r],i=e[r];if(s){const o={name:r,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto&&!Fn)o.recreate=!0,n.change.push(o);else{const a=s.idxByName,c=i.idxByName;let l;for(l in a)c[l]||o.del.push(l);for(l in c){const d=a[l],u=c[l];d?d.src!==u.src&&o.change.push(u):o.add.push(u)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}else n.add.push([r,i])}return n}function ur(t,e,n,r){const s=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(i=>Pr(s,i)),s}function Pr(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Cr(t,e,n){const r={};return Nn(e.objectStoreNames,0).forEach(s=>{const i=n.objectStore(s);let o=i.keyPath;const a=Dr(Yi(o),o||"",!1,!1,!!i.autoIncrement,o&&typeof o!="string",!0),c=[];for(let d=0;d<i.indexNames.length;++d){const u=i.index(i.indexNames[d]);o=u.keyPath;var l=Dr(u.name,o,!!u.unique,!!u.multiEntry,!1,o&&typeof o!="string",!1);c.push(l)}r[s]=qi(s,a,c)}),r}function Mr({_novip:t},e,n){const r=n.db.objectStoreNames;for(let s=0;s<r.length;++s){const i=r[s],o=n.objectStore(i);t._hasGetAll="getAll"in o;for(let a=0;a<o.indexNames.length;++a){const c=o.indexNames[a],l=o.index(c).keyPath,d=typeof l=="string"?l:"["+Nn(l).join("+")+"]";if(e[i]){const u=e[i].idxByName[d];u&&(u.name=c,delete e[i].idxByName[d],e[i].idxByName[c]=u)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&V.WorkerGlobalScope&&V instanceof V.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Fa{_parseStoresSpec(e,n){J(e).forEach(r=>{if(e[r]!==null){var s=e[r].split(",").map((o,a)=>{const c=(o=o.trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Dr(c,l||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),ie(l),a===0)}),i=s.shift();if(i.multi)throw new B.Schema("Primary key cannot be multi-valued");s.forEach(o=>{if(o.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),n[r]=qi(r,i,s)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?ce(this._cfg.storesSource,e):e;const r=n._versions,s={};let i={};return r.forEach(o=>{ce(s,o._cfg.storesSource),i=o._cfg.dbschema={},o._parseStoresSpec(s,i)}),n._dbSchema=i,Ir(n,[n._allTables,n,n.Transaction.prototype]),Bn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],J(i),i),n._storeNames=J(i),this}upgrade(e){return this._cfg.contentUpgrade=cs(this._cfg.contentUpgrade||q,e),this}}function fs(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new U(Ln,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function hs(t){return t&&typeof t.databases=="function"}function Br(t){return We(function(){return C.letThrough=!0,t()})}function La(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Ya(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Q(e.dbOpenError):t);Ee&&(e.openCanceller._stackHolder=ft()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function s(){if(e.openCanceller!==r)throw new B.DatabaseClosed("db.open() was cancelled")}let i=e.dbReadyResolve,o=null,a=!1;return I.race([r,(typeof navigator>"u"?I.resolve():La()).then(()=>new I((c,l)=>{if(s(),!n)throw new B.MissingAPI;const d=t.name,u=e.autoSchema?n.open(d):n.open(d,Math.round(10*t.verno));if(!u)throw new B.MissingAPI;u.onerror=be(l),u.onblocked=z(t._fireOnBlocked),u.onupgradeneeded=z(f=>{if(o=u.transaction,e.autoSchema&&!t._options.allowEmptyDB){u.onerror=zt,o.abort(),u.result.close();const g=n.deleteDatabase(d);g.onsuccess=g.onerror=z(()=>{l(new B.NoSuchDatabase(`Database ${d} doesnt exist`))})}else{o.onerror=be(l);var h=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;a=h<1,t._novip.idbdb=u.result,Ka(t,h/10,o,l)}},l),u.onsuccess=z(()=>{o=null;const f=t._novip.idbdb=u.result,h=Nn(f.objectStoreNames);if(h.length>0)try{const m=f.transaction((g=h).length===1?g[0]:g,"readonly");e.autoSchema?function({_novip:v},y,_){v.verno=y.version/10;const w=v._dbSchema=Cr(0,y,_);v._storeNames=Nn(y.objectStoreNames,0),Bn(v,[v._allTables],J(w),w)}(t,f,m):(Mr(t,t._dbSchema,m),function(v,y){const _=Hi(Cr(0,v.idbdb,y),v._dbSchema);return!(_.add.length||_.change.some(w=>w.add.length||w.change.length))}(t,m)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Ar(t,m)}catch{}var g;Ft.push(t),f.onversionchange=z(m=>{e.vcFired=!0,t.on("versionchange").fire(m)}),f.onclose=z(m=>{t.on("close").fire(m)}),a&&function({indexedDB:m,IDBKeyRange:v},y){!hs(m)&&y!==Ln&&fs(m,v).put({name:y}).catch(q)}(t._deps,d),c()},l)}))]).then(()=>(s(),e.onReadyBeingFired=[],I.resolve(Br(()=>t.on.ready.fire(t.vip))).then(function c(){if(e.onReadyBeingFired.length>0){let l=e.onReadyBeingFired.reduce(cs,q);return e.onReadyBeingFired=[],I.resolve(Br(()=>l(t.vip))).then(c)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(c=>{e.dbOpenError=c;try{o&&o.abort()}catch{}return r===e.openCanceller&&t._close(),Q(c)}).finally(()=>{e.openComplete=!0,i()})}function $r(t){var e=i=>t.next(i),n=s(e),r=s(i=>t.throw(i));function s(i){return o=>{var a=i(o),c=a.value;return a.done?c:c&&typeof c.then=="function"?c.then(n,r):ie(c)?Promise.all(c).then(n,r):n(c)}}return s(e)()}function qa(t,e,n){var r=arguments.length;if(r<2)throw new B.InvalidArgument("Too few arguments");for(var s=new Array(r-1);--r;)s[r-1]=arguments[r];return n=s.pop(),[t,Si(s),n]}function Gi(t,e,n,r,s){return I.resolve().then(()=>{const i=C.transless||C,o=t._createTransaction(e,n,t._dbSchema,r),a={trans:o,transless:i};if(r)o.idbtrans=r.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(u){return u.name===as.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Gi(t,e,n,null,s))):Q(u)}const c=is(s);let l;c&&xt();const d=I.follow(()=>{if(l=s.call(o,o),l)if(c){var u=Me.bind(null,null);l.then(u,u)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=$r(l))},a);return(l&&typeof l.then=="function"?I.resolve(l).then(u=>o.active?u:Q(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):d.then(()=>l)).then(u=>(r&&o._resolve(),o._completion.then(()=>u))).catch(u=>(o._reject(u),Q(u)))})}function hn(t,e,n){const r=ie(t)?t.slice():[t];for(let s=0;s<n;++s)r.push(e);return r}const Ha={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,s={},i=[];function o(d,u,f){const h=Yt(d),g=s[h]=s[h]||[],m=d==null?0:typeof d=="string"?1:d.length,v=u>0,y={...f,isVirtual:v,keyTail:u,keyLength:m,extractKey:Nr(d),unique:!v&&f.unique};return g.push(y),y.isPrimaryKey||i.push(y),m>1&&o(m===2?d[0]:d.slice(0,m-1),u+1,f),g.sort((_,w)=>_.keyTail-w.keyTail),y}const a=o(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[a];for(const d of r.indexes)o(d.keyPath,0,d);function c(d){const u=d.query.index;return u.isVirtual?{...d,query:{index:u,range:(f=d.query.range,h=u.keyTail,{type:f.type===1?2:f.type,lower:hn(f.lower,f.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:hn(f.upper,f.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0})}}:d;var f,h}return{...n,schema:{...r,primaryKey:a,indexes:i,getIndexByKeyPath:function(d){const u=s[Yt(d)];return u&&u[0]}},count:d=>n.count(c(d)),query:d=>n.query(c(d)),openCursor(d){const{keyTail:u,isVirtual:f,keyLength:h}=d.query.index;return f?n.openCursor(c(d)).then(g=>g&&function(m){return Object.create(m,{continue:{value:function(y){y!=null?m.continue(hn(y,d.reverse?t.MAX_KEY:t.MIN_KEY,u)):d.unique?m.continue(m.key.slice(0,h).concat(d.reverse?t.MIN_KEY:t.MAX_KEY,u)):m.continue()}},continuePrimaryKey:{value(y,_){m.continuePrimaryKey(hn(y,t.MAX_KEY,u),_)}},primaryKey:{get:()=>m.primaryKey},key:{get(){const y=m.key;return h===1?y[0]:y.slice(0,h)}},value:{get:()=>m.value}})}(g)):n.openCursor(d)}}}}}};function ps(t,e,n,r){return n=n||{},r=r||"",J(t).forEach(s=>{if(he(e,s)){var i=t[s],o=e[s];if(typeof i=="object"&&typeof o=="object"&&i&&o){const a=_r(i);a!==_r(o)?n[r+s]=e[s]:a==="Object"?ps(i,o,n,r+s+"."):i!==o&&(n[r+s]=e[s])}else i!==o&&(n[r+s]=e[s])}else n[r+s]=void 0}),J(e).forEach(s=>{he(t,s)||(n[r+s]=e[s])}),n}const Ga={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(i){const o=C.trans,{deleting:a,creating:c,updating:l}=o.table(e).hook;switch(i.type){case"add":if(c.fire===q)break;return o._promise("readwrite",()=>d(i),!0);case"put":if(c.fire===q&&l.fire===q)break;return o._promise("readwrite",()=>d(i),!0);case"delete":if(a.fire===q)break;return o._promise("readwrite",()=>d(i),!0);case"deleteRange":if(a.fire===q)break;return o._promise("readwrite",()=>function(f){return u(f.trans,f.range,1e4)}(i),!0)}return n.mutate(i);function d(f){const h=C.trans,g=f.keys||function(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}(r,f);if(!g)throw new Error("Keys missing");return(f=f.type==="add"||f.type==="put"?{...f,keys:g}:{...f}).type!=="delete"&&(f.values=[...f.values]),f.keys&&(f.keys=[...f.keys]),function(m,v,y){return v.type==="add"?Promise.resolve([]):m.getMany({trans:v.trans,keys:y,cache:"immutable"})}(n,f,g).then(m=>{const v=g.map((y,_)=>{const w=m[_],A={onerror:null,onsuccess:null};if(f.type==="delete")a.fire.call(A,y,w,h);else if(f.type==="add"||w===void 0){const T=c.fire.call(A,y,f.values[_],h);y==null&&T!=null&&(y=T,f.keys[_]=y,r.outbound||ye(f.values[_],r.keyPath,y))}else{const T=ps(w,f.values[_]),k=l.fire.call(A,T,y,w,h);if(k){const S=f.values[_];Object.keys(k).forEach(j=>{he(S,j)?S[j]=k[j]:ye(S,j,k[j])})}}return A});return n.mutate(f).then(({failures:y,results:_,numFailures:w,lastResult:A})=>{for(let T=0;T<g.length;++T){const k=_?_[T]:g[T],S=v[T];k==null?S.onerror&&S.onerror(y[T]):S.onsuccess&&S.onsuccess(f.type==="put"&&m[T]?f.values[T]:k)}return{failures:y,results:_,numFailures:w,lastResult:A}}).catch(y=>(v.forEach(_=>_.onerror&&_.onerror(y)),Promise.reject(y)))})}function u(f,h,g){return n.query({trans:f,values:!1,query:{index:r,range:h},limit:g}).then(({result:m})=>d({type:"delete",keys:m,trans:f}).then(v=>v.numFailures>0?Promise.reject(v.failures[0]):m.length<g?{failures:[],numFailures:0,lastResult:void 0}:u(f,{...h,lower:m[m.length-1],lowerOpen:!0},g)))}}}}})};function Wi(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let s=0,i=0;s<e.keys.length&&i<t.length;++s)ae(e.keys[s],t[i])===0&&(r.push(n?en(e.values[s]):e.values[s]),++i);return r.length===t.length?r:null}catch{return null}}const Wa={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const s=Wi(r.keys,r.trans._cache,r.cache==="clone");return s?I.resolve(s):n.getMany(r).then(i=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?en(i):i},i))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function ms(t){return!("from"in t)}const De=function(t,e){if(!this){const n=new De;return t&&"d"in t&&ce(n,t),n}ce(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Qt(t,e,n){const r=ae(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(ms(t))return ce(t,{from:e,to:n,d:1});const s=t.l,i=t.r;if(ae(n,t.from)<0)return s?Qt(s,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Us(t);if(ae(e,t.to)>0)return i?Qt(i,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Us(t);ae(e,t.from)<0&&(t.from=e,t.l=null,t.d=i?i.d+1:1),ae(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const o=!t.r;s&&!t.l&&$n(t,s),i&&o&&$n(t,i)}function $n(t,e){ms(e)||function n(r,{from:s,to:i,l:o,r:a}){Qt(r,s,i),o&&n(r,o),a&&n(r,a)}(t,e)}function Va(t,e){const n=jr(e);let r=n.next();if(r.done)return!1;let s=r.value;const i=jr(t);let o=i.next(s.from),a=o.value;for(;!r.done&&!o.done;){if(ae(a.from,s.to)<=0&&ae(a.to,s.from)>=0)return!0;ae(s.from,a.from)<0?s=(r=n.next(a.from)).value:a=(o=i.next(s.from)).value}return!1}function jr(t){let e=ms(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&ae(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||ae(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Us(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),s=r>1?"r":r<-1?"l":"";if(s){const i=s==="r"?"l":"r",o={...t},a=t[s];t.from=a.from,t.to=a.to,t[s]=a[s],o[s]=a[i],t[i]=o,o.d=Ks(o)}t.d=Ks(t)}function Ks({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}wt(De.prototype,{add(t){return $n(this,t),this},addKey(t){return Qt(this,t,t),this},addKeys(t){return t.forEach(e=>Qt(this,e,e)),this},[yr](){return jr(this)}});const za={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new De(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const s=t.table(r),{schema:i}=s,{primaryKey:o}=i,{extractKey:a,outbound:c}=o,l={...s,mutate:f=>{const h=f.trans,g=h.mutatedParts||(h.mutatedParts={}),m=k=>{const S=`idb://${e}/${r}/${k}`;return g[S]||(g[S]=new De)},v=m(""),y=m(":dels"),{type:_}=f;let[w,A]=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[];const T=f.trans._cache;return s.mutate(f).then(k=>{if(ie(w)){_!=="delete"&&(w=k.results),v.addKeys(w);const S=Wi(w,T);S||_==="add"||y.addKeys(w),(S||A)&&function(j,b,P,R){function Y(L){const D=j(L.name||"");function O(N){return N!=null?L.extractKey(N):null}const E=N=>L.multiEntry&&ie(N)?N.forEach(x=>D.addKey(x)):D.addKey(N);(P||R).forEach((N,x)=>{const M=P&&O(P[x]),$=R&&O(R[x]);ae(M,$)!==0&&(M!=null&&E(M),$!=null&&E($))})}b.indexes.forEach(Y)}(m,i,S,A)}else if(w){const S={from:w.lower,to:w.upper};y.add(S),v.add(S)}else v.add(n),y.add(n),i.indexes.forEach(S=>m(S.name).add(n));return k})}},d=({query:{index:f,range:h}})=>{var g,m;return[f,new De((g=h.lower)!==null&&g!==void 0?g:t.MIN_KEY,(m=h.upper)!==null&&m!==void 0?m:t.MAX_KEY)]},u={get:f=>[o,new De(f.key)],getMany:f=>[o,new De().addKeys(f.keys)],count:d,query:d,openCursor:d};return J(u).forEach(f=>{l[f]=function(h){const{subscr:g}=C;if(g){const m=A=>{const T=`idb://${e}/${r}/${A}`;return g[T]||(g[T]=new De)},v=m(""),y=m(":dels"),[_,w]=u[f](h);if(m(_.name||"").add(w),!_.isPrimaryKey){if(f!=="count"){const A=f==="query"&&c&&h.values&&s.query({...h,values:!1});return s[f].apply(this,arguments).then(T=>{if(f==="query"){if(c&&h.values)return A.then(({result:S})=>(v.addKeys(S),T));const k=h.values?T.result.map(a):T.result;h.values?v.addKeys(k):y.addKeys(k)}else if(f==="openCursor"){const k=T,S=h.values;return k&&Object.create(k,{key:{get:()=>(y.addKey(k.primaryKey),k.key)},primaryKey:{get(){const j=k.primaryKey;return y.addKey(j),j}},value:{get:()=>(S&&v.addKey(k.primaryKey),k.value)}})}return T})}y.add(n)}}return s[f].apply(this,arguments)}}),l}}}};class U{constructor(e,n){this._middlewares={},this.verno=0;const r=U.dependencies;this._options=n={addons:U.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:q,dbReadyPromise:null,cancelOpen:q,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;i.dbReadyPromise=new I(a=>{i.dbReadyResolve=a}),i.openCanceller=new I((a,c)=>{i.cancelOpen=c}),this._state=i,this.name=e,this.on=Lt(this,"populate","blocked","versionchange","close",{ready:[cs,q]}),this.on.ready.subscribe=vi(this.on.ready.subscribe,a=>(c,l)=>{U.vip(()=>{const d=this._state;if(d.openComplete)d.dbOpenError||I.resolve().then(c),l&&a(c);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(c),l&&a(c);else{a(c);const u=this;l||a(function f(){u.on.ready.unsubscribe(c),u.on.ready.unsubscribe(f)})}})}),this.Collection=(o=this,At(Ia.prototype,function(a,c){this.db=o;let l=Ki,d=null;if(c)try{l=c()}catch(g){d=g}const u=a._ctx,f=u.table,h=f.hook.reading.fire;this._ctx={table:f,index:u.index,isPrimKey:!u.index||f.schema.primKey.keyPath&&u.index===f.schema.primKey.name,range:l,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:u.or,valueMapper:h!==Wt?h:null}})),this.Table=function(a){return At(Aa.prototype,function(c,l,d){this.db=a,this._tx=d,this.name=c,this.schema=l,this.hook=a._allTables[c]?a._allTables[c].hook:Lt(null,{creating:[va,q],reading:[ga,Wt],updating:[wa,q],deleting:[ba,q]})})}(this),this.Transaction=function(a){return At(Ba.prototype,function(c,l,d,u,f){this.db=a,this.mode=c,this.storeNames=l,this.schema=d,this.chromeTransactionDurability=u,this.idbtrans=null,this.on=Lt(this,"complete","error","abort"),this.parent=f||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new I((h,g)=>{this._resolve=h,this._reject=g}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var g=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):g&&this.idbtrans&&this.idbtrans.abort(),Q(h)})})}(this),this.Version=function(a){return At(Fa.prototype,function(c){this.db=a,this._cfg={version:c,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return At(Li.prototype,function(c,l,d){this.db=a,this._ctx={table:c,index:l===":id"?null:l,or:d};const u=a._deps.indexedDB;if(!u)throw new B.MissingAPI;this._cmp=this._ascending=u.cmp.bind(u),this._descending=(f,h)=>u.cmp(h,f),this._max=(f,h)=>u.cmp(f,h)>0?f:h,this._min=(f,h)=>u.cmp(f,h)<0?f:h,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=Jt(n.IDBKeyRange),this._createTransaction=(a,c,l,d)=>new this.Transaction(a,c,l,this._options.chromeTransactionDurability,d),this._fireOnBlocked=a=>{this.on("blocked").fire(a),Ft.filter(c=>c.name===this.name&&c!==this&&!c._state.vcFired).map(c=>c.on("versionchange").fire(a))},this.use(Ha),this.use(Ga),this.use(za),this.use(Wa),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new B.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(s=>s._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(Ua),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||C.letThrough||this._vip)?e():new I((n,r)=>{if(this._state.openComplete)return r(new B.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new B.DatabaseClosed);this.open().catch(q)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:s}){s&&this.unuse({stack:e,name:s});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:n,level:r??10,name:s}),i.sort((o,a)=>o.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(s=>r?s.create!==r:!!n&&s.name!==n)),this}open(){return Ya(this)}_close(){const e=this._state,n=Ft.indexOf(this);if(n>=0&&Ft.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new I(r=>{e.dbReadyResolve=r}),e.openCanceller=new I((r,s)=>{e.cancelOpen=s})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new B.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new I((r,s)=>{const i=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=z(()=>{(function({indexedDB:a,IDBKeyRange:c},l){!hs(a)&&l!==Ln&&fs(a,c).delete(l).catch(q)})(this._deps,this.name),r()}),o.onerror=be(s),o.onblocked=this._fireOnBlocked};if(e)throw new B.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return J(this._allTables).map(e=>this._allTables[e])}transaction(){const e=qa.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let s=C.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);const i=e.indexOf("?")!==-1;let o,a;e=e.replace("!","").replace("?","");try{if(a=n.map(l=>{var d=l instanceof this.Table?l.name:l;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===sr)o=sr;else{if(e!="rw"&&e!=ir)throw new B.InvalidArgument("Invalid transaction mode: "+e);o=ir}if(s){if(s.mode===sr&&o===ir){if(!i)throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&a.forEach(l=>{if(s&&s.storeNames.indexOf(l)===-1){if(!i)throw new B.SubTransaction("Table "+l+" not included in parent transaction.");s=null}}),i&&s&&!s.active&&(s=null)}}catch(l){return s?s._promise(null,(d,u)=>{u(l)}):Q(l)}const c=Gi.bind(null,this,o,a,s,r);return s?s._promise(o,c,"lock"):C.trans?Tt(C.transless,()=>this._whenReady(c)):this._whenReady(c)}table(e){if(!he(this._allTables,e))throw new B.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Xa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Ja{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[Xa](){return this}}function Vi(t,e){return J(e).forEach(n=>{$n(t[n]||(t[n]=new De),e[n])}),t}function Qa(t){let e,n=!1;const r=new Ja(s=>{const i=is(t);let o=!1,a={},c={};const l={get closed(){return o},unsubscribe:()=>{o=!0,ze.storagemutated.unsubscribe(h)}};s.start&&s.start(l);let d=!1,u=!1;function f(){return J(c).some(m=>a[m]&&Va(a[m],c[m]))}const h=m=>{Vi(a,m),f()&&g()},g=()=>{if(d||o)return;a={};const m={},v=function(y){i&&xt();const _=()=>We(t,{subscr:y,trans:null}),w=C.trans?Tt(C.transless,_):_();return i&&w.then(Me,Me),w}(m);u||(ze(Xt,h),u=!0),d=!0,Promise.resolve(v).then(y=>{n=!0,e=y,d=!1,o||(f()?g():(a={},c=m,s.next&&s.next(y)))},y=>{d=!1,n=!1,s.error&&s.error(y),l.unsubscribe()})};return g(),l});return r.hasValue=()=>n,r.getValue=()=>e,r}let Ur;try{Ur={indexedDB:V.indexedDB||V.mozIndexedDB||V.webkitIndexedDB||V.msIndexedDB,IDBKeyRange:V.IDBKeyRange||V.webkitIDBKeyRange}}catch{Ur={indexedDB:null,IDBKeyRange:null}}const Ze=U;function Dn(t){let e=Ie;try{Ie=!0,ze.storagemutated.fire(t)}finally{Ie=e}}wt(Ze,{...Sn,delete:t=>new Ze(t,{addons:[]}).delete(),exists:t=>new Ze(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return hs(e)?Promise.resolve(e.databases()).then(r=>r.map(s=>s.name).filter(s=>s!==Ln)):fs(e,n).toCollection().primaryKeys()}(Ze.dependencies).then(t)}catch{return Q(new B.MissingAPI)}},defineClass:()=>function(t){ce(this,t)},ignoreTransaction:t=>C.trans?Tt(C.transless,t):t(),vip:Br,async:function(t){return function(){try{var e=$r(t.apply(this,arguments));return e&&typeof e.then=="function"?e:I.resolve(e)}catch(n){return Q(n)}}},spawn:function(t,e,n){try{var r=$r(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:I.resolve(r)}catch(s){return Q(s)}},currentTransaction:{get:()=>C.trans||null},waitFor:function(t,e){const n=I.resolve(typeof t=="function"?Ze.ignoreTransaction(t):t).timeout(e||6e4);return C.trans?C.trans.waitFor(n):n},Promise:I,debug:{get:()=>Ee,set:t=>{xi(t,t==="dexie"?()=>!0:Ui)}},derive:yt,extend:ce,props:wt,override:vi,Events:Lt,on:ze,liveQuery:Qa,extendObservabilitySet:Vi,getByKeyPath:Ce,setByKeyPath:ye,delByKeyPath:function(t,e){typeof e=="string"?ye(t,e,void 0):"length"in e&&[].map.call(e,function(n){ye(t,n,void 0)})},shallowClone:Ei,deepClone:en,getObjectDiff:ps,cmp:ae,asap:bi,minKey:Or,addons:[],connections:Ft,errnames:as,dependencies:Ur,semVer:Ps,version:Ps.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Ze.maxKey=Jt(Ze.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ze(Xt,t=>{if(!Ie){let e;Fn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Le,!0,!0,t)):e=new CustomEvent(Le,{detail:t}),Ie=!0,dispatchEvent(e),Ie=!1}}),addEventListener(Le,({detail:t})=>{Ie||Dn(t)}));let Ie=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(Le);typeof t.unref=="function"&&t.unref(),ze(Xt,e=>{Ie||t.postMessage(e)}),t.onmessage=e=>{e.data&&Dn(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ze(Xt,e=>{try{Ie||(typeof localStorage<"u"&&localStorage.setItem(Le,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:Le,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===Le){const n=JSON.parse(e.newValue);n&&Dn(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===Le&&Dn(e.changedParts)})}I.rejectionMapper=function(t,e){if(!t||t instanceof gt||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Ds[t.name])return t;var n=new Ds[t.name](e||t.message,t);return"stack"in t&&Pe(n,"stack",{get:function(){return this.inner.stack}}),n},xi(Ee,Ui);function zi(){}function Za(t,e){return t===zi?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){var r=this,s=arguments;return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}function ec(){var t=Date.now(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n==="x"?r:r&7|8).toString(16)});return e}function tc(t,e){return function(r){return function(s,i,o,a){if(t.dynamicallyOpened())return r.apply(this,arguments);var c=!1;s==="readwrite"&&i.some(function(d){return o[d]&&o[d].observable})&&(c=!0,i=i.slice(0),i.indexOf("_changes")===-1&&i.push("_changes"));var l=r.call(this,s,i,o,a);return c&&(l._lastWrittenRevision=0,l.on("complete",function(){if(l._lastWrittenRevision)if(!a)e.timeoutHandle&&clearTimeout(e.timeoutHandle),e.timeoutHandle=setTimeout(function(){delete e.timeoutHandle,e(l._lastWrittenRevision)},25);else{var d=function u(f){return f.parent?u(f.parent):f}(a);d._lastWrittenRevision=Math.max(l._lastWrittenRevision,d.lastWrittenRevision||0)}}),l.parent&&l.parent.source&&(l.source=l.parent.source)),l}}}function nc(t,e,n){return function(s){e.latestRevision[t.name]<s&&(e.latestRevision[t.name]=s,U.ignoreTransaction(function(){e.on("latestRevisionIncremented").fire(t.name,s)}),n&&n.setItem("Dexie.Observable/latestRevision/"+t.name,s))}}var rc=1,sc=2,ic=3;function oc(t,e){return function(r,s,i){var o=void 0;r===void 0&&e.schema.primKey.uuid&&(r=o=U.Observable.createUUID(),e.schema.primKey.keyPath&&U.setByKeyPath(s,e.schema.primKey.keyPath,r));var a={source:i.source||null,table:e.name,key:r===void 0?null:r,type:rc,obj:s},c=t._changes.add(a).then(function(l){return i._lastWrittenRevision=Math.max(i._lastWrittenRevision,l),l});return this.onsuccess=function(l){r!=l&&c._then(function(){a.key=l,t._changes.put(a)})},this.onerror=function(){c._then(function(l){t._changes.delete(l)})},o}}function ac(t,e){return function(r,s,i,o){var a={},c=!1,l=U.deepClone(i);for(var d in r){var u=r[d];if(typeof u>"u")U.delByKeyPath(l,d),a[d]=null,c=!0;else{var f=U.getByKeyPath(i,d);u!==f&&JSON.stringify(u)!==JSON.stringify(f)&&(U.setByKeyPath(l,d,u),a[d]=u,c=!0)}}if(c){var h={source:o.source||null,table:e,key:s,type:sc,mods:a,oldObj:i,obj:l},g=t._changes.add(h);this.onsuccess=function(){g._then(function(m){o._lastWrittenRevision=Math.max(o._lastWrittenRevision,m)})},this.onerror=function(){g._then(function(m){t._changes.delete(m)})}}}}function cc(t,e){return function(r,s,i){var o=t._changes.add({source:i.source||null,table:e,key:r,type:ic,oldObj:s}).then(function(a){return i._lastWrittenRevision=Math.max(i._lastWrittenRevision,a),a}).catch(function(a){console.log(s),console.log(a.stack)});this.onerror=function(){o._then(function(a){t._changes.delete(a)})}}}function uc(t){return function(n){if(!n.hook._observing){n.hook._observing=!0;var r=n.name;n.hook("creating").subscribe(oc(t,n)),n.hook("updating").subscribe(ac(t,r)),n.hook("deleting").subscribe(cc(t,r))}}}function lc(t){return function(n){if(n.key&&n.key.indexOf("Dexie.Observable/")===0){var r=n.key.split("/"),s=r[1],i=r[2];if(s==="latestRevision"){var o=parseInt(n.newValue,10);!isNaN(o)&&o>t.latestRevision[i]&&(t.latestRevision[i]=o,U.ignoreTransaction(function(){t.on("latestRevisionIncremented").fire(i,o)}))}else if(s.indexOf("deadnode:")===0){var a=parseInt(s.split(":")[1],10);n.newValue&&t.on.suicideNurseCall.fire(i,a)}else s==="intercomm"&&n.newValue&&t.on.intercomm.fire(i)}}}function dc(t,e,n){return function(s){return function(){return Object.keys(t._allTables).forEach(function(i){var o=t._allTables[i];o.schema.observable&&n(o),o.name==="_syncNodes"&&o.mapToClass(e)}),s.apply(this,arguments)}}}var It=U.Promise;function fc(t,e,n,r,s){var i={};t.observable.sendMessage=function(l,d,u,f){if(f=f||{},!r.node)return f.wantReply?It.reject(new U.DatabaseClosedError):It.resolve();var h={message:d,destinationNode:u,sender:r.node.id,type:l};return U.extend(h,f),U.ignoreTransaction(function(){var g=["_intercomm"];f.wantReply&&g.push("_syncNodes");var m=t.transaction("rw",g,function(){return f.wantReply?t._syncNodes.where("id").equals(u).count(function(v){return v?t._intercomm.add(h):t._syncNodes.where("isMaster").above(0).first(function(y){return h.destinationNode=y.id,t._intercomm.add(h)})}):t._intercomm.add(h)}).then(function(v){var y=null;return f.wantReply&&(y=new It(function(_,w){i[v.toString()]={resolve:_,reject:w}})),s&&s.setItem("Dexie.Observable/intercomm/"+t.name,v.toString()),e.on.intercomm.fire(t.name),y});if(f.wantReply)return m;m.catch(function(){})})},t.observable.broadcastMessage=function(l,d,u){if(r.node){var f=r.node.id;U.ignoreTransaction(function(){t._syncNodes.toArray(function(h){return It.all(h.filter(function(g){return g.type==="local"&&(u||g.id!==f)}).map(function(g){return t.observable.sendMessage(l,d,g.id)}))}).catch(function(){})})}};function o(){return r.node?U.ignoreTransaction(function(){return t.transaction("rw","_intercomm",function(){return t._intercomm.where({destinationNode:r.node.id}).toArray(function(l){return l.forEach(function(d){return a(d)}),t._intercomm.where("id").anyOf(l.map(function(d){return d.id})).delete()})})}):It.reject(new U.DatabaseClosedError)}function a(l){if(l.type==="response"){var d=i[l.requestId.toString()];d&&(l.isFailure?d.reject(l.message.error):d.resolve(l.message.result),delete i[l.requestId.toString()])}else l.resolve=function(u){t.observable.sendMessage("response",{result:u},l.sender,{requestId:l.id})},l.reject=function(u){t.observable.sendMessage("response",{error:u.toString()},l.sender,{isFailure:!0,requestId:l.id})},t.on.message.fire(l)}function c(l){l===t.name&&o().catch("DatabaseClosedError",function(){})}return{onIntercomm:c,consumeIntercommMessages:o}}function hc(t){return function(e,n){e._changes="++rev",e._syncNodes="++id,myRevision,lastHeartBeat,&url,isMaster,type,status",e._intercomm="++id,destinationNode",e._uncommittedChanges="++id,node",t.call(this,e,n),Object.keys(n).forEach(function(r){var s=n[r];s.primKey.name.indexOf("$$")===0&&(s.primKey.uuid=!0,s.primKey.name=s.primKey.name.substr(2),s.primKey.keyPath=s.primKey.keyPath.substr(2))}),Object.keys(n).forEach(function(r){r.indexOf("_")!==0&&r.indexOf("$")!==0&&(n[r].observable=!0)})}}function Xi(t){var e=100;U.ignoreTransaction(function(){return t._syncNodes.orderBy("myRevision").first(function(n){return t._changes.where("rev").below(n.myRevision).limit(e).primaryKeys()}).then(function(n){if(n.length!==0)return t._changes.bulkDelete(n).then(function(){n.length===e&&setTimeout(function(){return t.isOpen()&&Xi(t)},500)})})}).catch(function(){})}var Ye=self,pc=U.defineClass({rev:Number,source:String,table:String,key:Object,type:Number,obj:Object,mods:Object,oldObj:Object}),Pt=U.override,Fs=U.Promise,Ls=!1;function F(t){if(!/^(3|4)\./.test(U.version))throw new Error("Missing dexie version 3.x or 4.x");if(t.observable){if(t.observable.version!=="{version}")throw new Error("Mixed versions of dexie-observable");return}var e=2e4,n=2e4,r=500,s=e-5e3,i=F.localStorageImpl,o=U.defineClass({myRevision:Number,type:String,lastHeartBeat:Number,deleteTimeStamp:Number,url:String,isMaster:Number,syncProtocol:String,syncContext:null,syncOptions:Object,connected:!1,status:Number,appliedRemoteRevision:null,remoteBaseRevisions:[{local:Number,remote:null}],dbUploadState:{tablesToUpload:[String],currentTable:String,currentKey:null,localBaseRevision:Number}});t.observable={version:"{version}"},t.observable.SyncNode=o;var a=nc(t,F,i),c=tc(t,a),l=uc(t),d=dc(t,o,l),u={node:null},f=fc(t,F,o,u,i),h=f.onIntercomm,g=f.consumeIntercommMessages;Object.defineProperty(t,"_localSyncNode",{get:function(){return u.node}});var m=null,v=null;U.fake&&(t.version(1).stores({_syncNodes:"++id,myRevision,lastHeartBeat",_changes:"++rev",_intercomm:"++id,destinationNode",_uncommittedChanges:"++id,node"}),t._syncNodes.mapToClass(o),t._changes.mapToClass(pc),u.node=new o({myRevision:0,type:"local",lastHeartBeat:Date.now(),deleteTimeStamp:null})),t.Version.prototype._parseStoresSpec=Pt(t.Version.prototype._parseStoresSpec,hc),t.on.addEventType({changes:"asap",cleanup:[Za,zi],message:"asap"}),t._createTransaction=Pt(t._createTransaction,c),F.latestRevision[t.name]=F.latestRevision[t.name]||0,t.open=Pt(t.open,d),t.close=Pt(t.close,function(b){return function(){return t.dynamicallyOpened()?b.apply(this,arguments):(a.timeoutHandle&&(clearTimeout(a.timeoutHandle),delete a.timeoutHandle),F.on("latestRevisionIncremented").unsubscribe(_),F.on("suicideNurseCall").unsubscribe(j),F.on("intercomm").unsubscribe(h),F.on("beforeunload").unsubscribe(S),u.node&&u.node.id&&(F.on.suicideNurseCall.fire(t.name,u.node.id),i&&i.setItem("Dexie.Observable/deadnode:"+u.node.id.toString()+"/"+t.name,"dead"),u.node.deleteTimeStamp=1,u.node.lastHeartBeat=0,t._syncNodes.put(u.node),u.node=null),m&&clearTimeout(m),m=null,v&&clearTimeout(v),v=null,b.apply(this,arguments))}}),t.delete=Pt(t.delete,function(b){return function(){return b.apply(this,arguments).then(function(P){return F.latestRevision[t.name]=0,P})}}),t.on("ready",function(){return t.dynamicallyOpened()?t:t.table("_changes").orderBy("rev").last(function(P){var R=P?P.rev:0;return u.node=new o({myRevision:R,type:"local",lastHeartBeat:Date.now(),deleteTimeStamp:null,isMaster:0}),F.latestRevision[t.name]<R&&(F.latestRevision[t.name]=R,U.ignoreTransaction(function(){F.on.latestRevisionIncremented.fire(R)})),t._syncNodes.put(u.node).then(U.ignoreTransaction(function(){var Y=1;return t._syncNodes.orderBy("isMaster").reverse().modify(function(L){L.isMaster&&(L.lastHeartBeat<Date.now()-e?L.isMaster=0:Y=0),u.node&&L.id===u.node.id&&(L.isMaster=u.node.isMaster=Y)})})).then(function(){F.on("latestRevisionIncremented",_),F.on("beforeunload",S),F.on("suicideNurseCall",j),F.on("intercomm",h),m=setTimeout(T,r),v=setTimeout(A,s)}).then(function(){k()})})},!0);var y=0;function _(b,P){if(b===t.name){if(y>=P)return;y=P,U.vip(function(){w().catch("DatabaseClosedError",function(){})})}}function w(b,P,R){if(!P&&w.ongoingOperation)return w.ongoingOperation;var Y=!1,L=u.node;if(!L)return Fs.reject(new U.DatabaseClosedError);var D=1e3,O=t._changes.where("rev").above(L.myRevision).limit(D).toArray(function(E){if(E.length>0){var N=E[E.length-1];Y=E.length===D,t.on("changes").fire(E,Y),L.myRevision=N.rev}else R&&t.on("changes").fire([],!1);var x=!1;return t._syncNodes.where(":id").equals(L.id).modify(function(M){x=!0,M.lastHeartBeat=Date.now(),M.deleteTimeStamp=null,M.myRevision=Math.max(M.myRevision,L.myRevision)}).then(function(){return x})}).then(function(E){if(!E)throw Ls?new Error("Browser is shutting down"):(t.close(),console.error("Out of sync"),Ye.location&&Ye.location.reload(!0),new Error("Out of sync"));if(Y||F.latestRevision[t.name]>L.myRevision)return w(F.latestRevision[t.name],(P||0)+1,Y)}).finally(function(){delete w.ongoingOperation});return P||(w.ongoingOperation=O),O}function A(){v=null;var b=u.node&&u.node.id;b&&t.transaction("rw!",t._syncNodes,function(){t._syncNodes.where({id:b}).first(function(P){if(!P){t.isOpen()&&t.close();return}return P.lastHeartBeat=Date.now(),P.deleteTimeStamp=null,t._syncNodes.put(P)})}).catch("DatabaseClosedError",function(){}).finally(function(){u.node&&u.node.id===b&&t.isOpen()&&(v=setTimeout(A,s))})}function T(){m=null;var b=u.node&&u.node.id;b&&U.vip(function(){w(F.latestRevision[t.name]).then(k).then(g).catch("DatabaseClosedError",function(){}).finally(function(){u.node&&u.node.id===b&&t.isOpen()&&(m=setTimeout(T,r))})})}function k(){var b=u.node;return b?t.transaction("rw","_syncNodes","_changes","_intercomm",function(){var P=!1;t._syncNodes.where("lastHeartBeat").below(Date.now()-e).filter(function(R){return R.type==="local"}).modify(function(R){R.deleteTimeStamp&&R.deleteTimeStamp<Date.now()?(delete this.value,i&&i.removeItem("Dexie.Observable/deadnode:"+R.id+"/"+t.name),R.isMaster&&(t._syncNodes.update(b,{isMaster:1}),P=!0),t._intercomm.where({destinationNode:R.id}).modify(function(Y){Y.wantReply?Y.destinationNode=b.id:delete this.value})):R.deleteTimeStamp||(R.deleteTimeStamp=Date.now()+n)}).then(function(){return F.deleteOldChanges(t),t.on("cleanup").fire(P)})}):Fs.reject(new U.DatabaseClosedError)}function S(){u.node&&(Ls=!0,u.node.deleteTimeStamp=1,u.node.lastHeartBeat=0,t._syncNodes.put(u.node),F.wereTheOneDying=!0,i&&i.setItem("Dexie.Observable/deadnode:"+u.node.id.toString()+"/"+t.name,"dead"))}function j(b,P){b===t.name&&!F.wereTheOneDying&&U.vip(function(){t._syncNodes.update(P,{deleteTimeStamp:1,lastHeartBeat:0}).then(k)})}}F.version="{version}";F.latestRevision={};F.on=U.Events(null,"latestRevisionIncremented","suicideNurseCall","intercomm","beforeunload");F.createUUID=ec;F.deleteOldChanges=Xi;F._onStorage=lc(F);F._onBeforeUnload=function(){F.on.beforeunload.fire()};try{F.localStorageImpl=Ye.localStorage}catch{}Ye?.addEventListener&&(Ye.addEventListener("storage",F._onStorage),Ye.addEventListener("beforeunload",F._onBeforeUnload));if(U.Observable){if(U.Observable.version!=="{version}")throw new Error("Mixed versions of dexie-observable")}else U.Observable=F,U.addons.push(F);U.Observable;var mc=9;class _c extends U{constructor(){super("FuelDB"),this.version(qo).stores({vaults:"key",accounts:"&address, &name",networks:"&id, &url, &name",connections:"origin",transactions:"&id",assets:"&assetId, &name, $symbol",abis:"&contractId",errors:"&id"}).upgrade(async e=>{await e.table("assets").toCollection().modify(n=>{n.decimals=mc})})}async clear(){await Promise.all([this.vaults.clear(),this.accounts.clear(),this.transactions.clear(),this.connections.clear(),this.networks.clear(),this.abis.clear(),this.errors.clear()])}}const p=new _c;function Md(t){return Array.isArray(t)?t:t?.split(" ")}function Bd(t){return Array.isArray(t)?t.join(" "):t||""}const $d=(t=13)=>Math.random().toString(16).slice(2).slice(0,t),jd=(t,e=30)=>t.length>e?`${t.substring(0,e)}...`:t,Kr=({desired:t,allValues:e})=>{if(!t)return t;function n(r){const{value:s,tries:i=1}=r,o=e.filter(c=>c&&c.trim()===s.trim());let a;if(o[0]){const c=`${s?.replace(/\(\d+\)?$/,"")} (${i})`;a=n({value:c,tries:i+1})}else a=s;return a}return n({value:t})};var yc=Object.defineProperty,gc=(t,e,n)=>e in t?yc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_e=(t,e,n)=>(gc(t,typeof e!="symbol"?e+"":e,n),n),_s=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},W=(t,e,n)=>(_s(t,e,"read from private field"),n?n.call(t):e.get(t)),nt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},me=(t,e,n,r)=>(_s(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ys=(t,e,n)=>(_s(t,e,"access private method"),n),vc=class{constructor(){Rs(this,"storage",new Map)}async getItem(t){return await this.storage.get(t)}async setItem(t,e){await this.storage.set(t,e)}async removeItem(t){await this.storage.delete(t)}async clear(){await this.storage.clear()}},bc=vc,et,Ji=class{constructor(t){nt(this,et,void 0),_e(this,"pathKey","{}"),_e(this,"rootPath",`m/44'/1179993420'/${this.pathKey}'/0/0`),_e(this,"numberOfAccounts",0),_e(this,"provider"),me(this,et,t.secret||Ho.generate()),this.rootPath=t.rootPath||this.rootPath,this.numberOfAccounts=t.numberOfAccounts||1,this.provider=t.provider}getDerivePath(t){return this.rootPath.includes(this.pathKey)?this.rootPath.replace(this.pathKey,String(t)):`${this.rootPath}/${t}`}serialize(){return{secret:W(this,et),rootPath:this.rootPath,numberOfAccounts:this.numberOfAccounts,provider:this.provider}}getAccounts(){const t=[];let e=0;do{const n=Ne.fromMnemonic(W(this,et),this.provider,this.getDerivePath(e));t.push({publicKey:n.publicKey,address:n.address}),e+=1}while(e<this.numberOfAccounts);return t}addAccount(){this.numberOfAccounts+=1;const t=Ne.fromMnemonic(W(this,et),this.provider,this.getDerivePath(this.numberOfAccounts-1));return{publicKey:t.publicKey,address:t.address}}exportAccount(t){let e=0;do{const n=Ne.fromMnemonic(W(this,et),this.provider,this.getDerivePath(e));if(n.address.equals(t))return n.privateKey;e+=1}while(e<this.numberOfAccounts);throw new Re(Oe.WALLET_MANAGER_ERROR,`Account with address '${t}' not found in derived wallets.`)}getWallet(t){const e=this.exportAccount(t);return Ne.fromPrivateKey(e,this.provider)}};et=new WeakMap;_e(Ji,"type","mnemonic");var je,Qi=class{constructor(t){_e(this,"provider"),nt(this,je,[]),this.provider=t.provider,t.secret?me(this,je,[t.secret]):me(this,je,t.accounts||[Ne.generate({provider:t.provider}).privateKey])}serialize(){return{accounts:W(this,je),provider:this.provider}}getPublicAccount(t){const e=Ne.fromPrivateKey(t,this.provider);return{address:e.address,publicKey:e.publicKey}}getAccounts(){return W(this,je).map(t=>this.getPublicAccount(t))}addAccount(){const t=Ne.generate({provider:this.provider});return W(this,je).push(t.privateKey),this.getPublicAccount(t.privateKey)}exportAccount(t){const e=W(this,je).find(n=>Ne.fromPrivateKey(n,this.provider).address.equals(t));if(!e)throw new Re(Oe.WALLET_MANAGER_ERROR,`No private key found for address '${t}'.`);return e}getWallet(t){const e=this.exportAccount(t);return Ne.fromPrivateKey(e,this.provider)}};je=new WeakMap;_e(Qi,"type","privateKey");var ke={invalid_vault_type:"The provided Vault type is invalid.",address_not_found:"No private key found for address the specified wallet address.",vault_not_found:"The specified vault was not found.",wallet_not_unlocked:"The wallet is currently locked.",passphrase_not_match:"The provided passphrase did not match the expected value."};function xe(t,e){if(!t)throw new Re(Oe.WALLET_MANAGER_ERROR,e)}var le,tt,ve,Fr,Zi,Lr,eo,to=class extends Go.EventEmitter{constructor(t){super(),nt(this,Fr),nt(this,Lr),_e(this,"storage",new bc),_e(this,"STORAGE_KEY","WalletManager"),nt(this,le,[]),nt(this,tt,""),nt(this,ve,!0),this.storage=t?.storage||this.storage}get isLocked(){return W(this,ve)}exportVault(t){xe(!W(this,ve),ke.wallet_not_unlocked);const e=W(this,le).find((n,r)=>r===t);return xe(e,ke.vault_not_found),e.vault.serialize()}getVaults(){return W(this,le).map((t,e)=>({title:t.title,type:t.type,vaultId:e}))}getAccounts(){return W(this,le).flatMap((t,e)=>t.vault.getAccounts().map(n=>({...n,vaultId:e})))}getWallet(t){const e=W(this,le).find(n=>n.vault.getAccounts().find(r=>r.address.equals(t)));return xe(e,ke.address_not_found),e.vault.getWallet(t)}exportPrivateKey(t){xe(!W(this,ve),ke.wallet_not_unlocked);const e=W(this,le).find(n=>n.vault.getAccounts().find(r=>r.address.equals(t)));return xe(e,ke.address_not_found),e.vault.exportAccount(t)}async addAccount(t){await this.loadState();const e=W(this,le)[t?.vaultId||0];await xe(e,ke.vault_not_found);const n=e.vault.addAccount();return await this.saveState(),n}async removeVault(t){W(this,le).splice(t,1),await this.saveState()}async addVault(t){await this.loadState();const e=this.getVaultClass(t.type),n=new e(t);me(this,le,W(this,le).concat({title:t.title,type:t.type,vault:n})),await this.saveState()}lock(){me(this,ve,!0),me(this,le,[]),me(this,tt,""),this.emit("lock")}async unlock(t){me(this,tt,t),me(this,ve,!1);try{await this.loadState(),this.emit("unlock")}catch(e){throw await this.lock(),e}}async updatePassphrase(t,e){const n=W(this,ve);await this.unlock(t),me(this,tt,e),await this.saveState(),await this.loadState(),n&&await this.lock()}async loadState(){await xe(!W(this,ve),ke.wallet_not_unlocked);const t=await this.storage.getItem(this.STORAGE_KEY);if(t){const e=await Wo(W(this,tt),JSON.parse(t));me(this,le,Ys(this,Lr,eo).call(this,e.vaults))}}async saveState(){await xe(!W(this,ve),ke.wallet_not_unlocked);const t=await Vo(W(this,tt),{vaults:Ys(this,Fr,Zi).call(this,W(this,le))});await this.storage.setItem(this.STORAGE_KEY,JSON.stringify(t)),this.emit("update")}getVaultClass(t){const e=to.Vaults.find(n=>n.type===t);return xe(e,ke.invalid_vault_type),e}},no=to;le=new WeakMap;tt=new WeakMap;ve=new WeakMap;Fr=new WeakSet;Zi=function(t){return t.map(({title:e,type:n,vault:r})=>({title:e,type:n,data:r.serialize()}))};Lr=new WeakSet;eo=function(t){return t.map(({title:e,type:n,data:r})=>{const s=this.getVaultClass(n);return{title:e,type:n,vault:new s(r)}})};_e(no,"Vaults",[Ji,Qi]);var wc=class{constructor(t){throw new Re(Oe.NOT_IMPLEMENTED,"Not implemented.")}serialize(){throw new Re(Oe.NOT_IMPLEMENTED,"Not implemented.")}getAccounts(){throw new Re(Oe.NOT_IMPLEMENTED,"Not implemented.")}addAccount(){throw new Re(Oe.NOT_IMPLEMENTED,"Not implemented.")}exportAccount(t){throw new Re(Oe.NOT_IMPLEMENTED,"Not implemented.")}getWallet(t){throw new Re(Oe.NOT_IMPLEMENTED,"Not implemented.")}};_e(wc,"type");class Ec{async getItem(e){return p.transaction("r",p.vaults,async()=>(await p.vaults.get({key:e}))?.data)}async setItem(e,n){await p.transaction("rw",p.vaults,p.accounts,async()=>{await p.vaults.put({key:e,data:n})})}async removeItem(e){await p.transaction("rw",p.vaults,p.accounts,async()=>{await p.vaults.where({key:e}).delete()})}async clear(){await p.transaction("rw",p.vaults,p.accounts,async()=>{await p.vaults.clear(),await p.accounts.clear()})}}const ro=class so extends zo{constructor(){super();const e=new Ec,n=new no({storage:e});this.manager=n,this.server=new Xo.JSONRPCServer,this.setupMethods()}setupMethods(){so.methods.forEach(e=>{if(!this[e])throw new Error("Method not exists!");this.server.addMethod(e,this[e].bind(this))})}async createVault({type:e,secret:n}){const r=await Ht.create(Jo);await this.manager.addVault({type:e,secret:n,provider:r});const s=await this.manager.getAccounts(),o=(await this.manager.getVaults()).length-1,[a]=s.slice(-1);return{address:a.address.toString(),publicKey:a.publicKey,vaultId:o}}async isLocked(){return this.manager.isLocked}async unlock({password:e}){await this.manager.unlock(e)}async lock(){await this.manager.lock()}async addAccount({vaultId:e}){const n=await this.manager.addAccount({vaultId:e});return{address:n.address.toString(),publicKey:n.publicKey,vaultId:n.vaultId||0}}async getAccounts(){return(await this.manager.getAccounts()).map(n=>({address:n.address.toString(),publicKey:n.publicKey,vaultId:n.vaultId||0}))}async signTransaction({transaction:e,address:n,providerUrl:r}){const s=await this.manager.getWallet(En.fromString(n)),i=Qo(JSON.parse(e)),o=await Ht.create(r);return s.connect(o),await s.signTransaction(i)}async signMessage({message:e,address:n}){return(await this.manager.getWallet(En.fromString(n))).signMessage(e)}async changePassword({currentPassword:e,password:n}){await this.manager.updatePassphrase(e,n)}async exportVault({vaultId:e,password:n}){return await this.manager.unlock(n),(await this.manager.exportVault(e)).secret||""}async exportPrivateKey({address:e,password:n}){return await this.manager.unlock(n),this.manager.exportPrivateKey(En.fromString(e))}};ro.methods=["isLocked","unlock","createVault","getAccounts","addAccount","signMessage","signTransaction","changePassword","exportVault","exportPrivateKey","lock"];let Ud=ro;function Sc(t){const e=typeof t=="string"?t:t.assetId;return Zo===ea(e)}class Bt{static async addAccount(e){return p.transaction("rw",p.accounts,async()=>{const n=await p.accounts.count(),r={...e.data,isCurrent:n===0,isHidden:!!e.data.isHidden};return await p.accounts.add(r),p.accounts.get({address:e.data.address})})}static async getAccounts(){return p.transaction("r",p.accounts,async()=>p.accounts.toCollection().sortBy("name"))}static async clearAccounts(){return p.transaction("rw",p.accounts,async()=>p.accounts.clear())}static async fetchAccount(e){const{address:n}=e,r=await p.transaction("r",p.accounts,async()=>p.accounts.get({address:n}));if(!r)throw new Error(`Account not found! ${n}`);return r}static async fetchBalance(e){if(!e.account)throw new Error("Account not defined");if(!e.providerUrl)throw new Error("Invalid Provider URL");const{account:n,providerUrl:r}=e;try{const s=await kc(r,n.publicKey),o=s.find(Sc)?.amount;return await Bt.setBalance({data:{address:n.address||"",balance:Os(o||0).toString(),balanceSymbol:"ETH",balances:s.map(c=>({...c,amount:c.amount.toString()}))}})??n}catch{return await Bt.setBalance({data:{address:n.address||"",balance:Os(0).toString(),balanceSymbol:"ETH",balances:[]}})??n}}static async setBalance(e){if(p.isOpen())return p.transaction("rw!",p.accounts,async()=>{const{address:n,...r}=e.data;return await p.accounts.update(n,r),p.accounts.get({address:e.data.address})})}static toMap(e){return e.reduce((n,r)=>({...n,[r.address]:r}),{})}static fromMap(e){return Object.values(e||{})}static getCurrentAccount(){return p.transaction("r",p.accounts,async()=>(await p.accounts.toArray()).find(e=>e.isCurrent))}static setCurrentAccount(e){return p.transaction("rw",p.accounts,async()=>(await p.accounts.filter(n=>!!n.isCurrent).modify({isCurrent:!1}),await p.accounts.update(e.address,{isCurrent:!0}),p.accounts.get(e.address)))}static updateAccount(e){if(!e.data)throw new Error("Account.data undefined");if(!e.address)throw new Error("Account.address undefined");return p.transaction("rw",p.accounts,async()=>(await p.accounts.update(e.address,e.data),p.accounts.get(e.address)))}static async checkAccountNameExists(e=""){const n=await Bt.getAccounts();return this.filterByName(n,e).length>0}static async generateAccountName(){const e=await Bt.getAccounts(),r=`Account ${e.length+1}`,s=e.map(({name:o})=>o);return Kr({desired:r,allValues:s})||r}static filterByName(e,n=""){return e.filter(r=>r.name.toLowerCase().includes(n.toLowerCase()))}}async function kc(t,e="0x00"){const n=await Ht.create(t),r=En.fromPublicKey(e);return await n.getBalances(r)}var io={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(ta,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",c="hour",l="day",d="week",u="month",f="quarter",h="year",g="date",m="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var O=["th","st","nd","rd"],E=D%100;return"["+D+(O[(E-20)%10]||O[E]||O[0])+"]"}},w=function(D,O,E){var N=String(D);return!N||N.length>=O?D:""+Array(O+1-N.length).join(E)+D},A={s:w,z:function(D){var O=-D.utcOffset(),E=Math.abs(O),N=Math.floor(E/60),x=E%60;return(O<=0?"+":"-")+w(N,2,"0")+":"+w(x,2,"0")},m:function D(O,E){if(O.date()<E.date())return-D(E,O);var N=12*(E.year()-O.year())+(E.month()-O.month()),x=O.clone().add(N,u),M=E-x<0,$=O.clone().add(N+(M?-1:1),u);return+(-(N+(E-x)/(M?x-$:$-x))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:u,y:h,w:d,d:l,D:g,h:c,m:a,s:o,ms:i,Q:f}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},T="en",k={};k[T]=_;var S="$isDayjsObject",j=function(D){return D instanceof Y||!(!D||!D[S])},b=function D(O,E,N){var x;if(!O)return T;if(typeof O=="string"){var M=O.toLowerCase();k[M]&&(x=M),E&&(k[M]=E,x=M);var $=O.split("-");if(!x&&$.length>1)return D($[0])}else{var G=O.name;k[G]=O,x=G}return!N&&x&&(T=x),x||!N&&T},P=function(D,O){if(j(D))return D.clone();var E=typeof O=="object"?O:{};return E.date=D,E.args=arguments,new Y(E)},R=A;R.l=b,R.i=j,R.w=function(D,O){return P(D,{locale:O.$L,utc:O.$u,x:O.$x,$offset:O.$offset})};var Y=function(){function D(E){this.$L=b(E.locale,null,!0),this.parse(E),this.$x=this.$x||E.x||{},this[S]=!0}var O=D.prototype;return O.parse=function(E){this.$d=function(N){var x=N.date,M=N.utc;if(x===null)return new Date(NaN);if(R.u(x))return new Date;if(x instanceof Date)return new Date(x);if(typeof x=="string"&&!/Z$/i.test(x)){var $=x.match(v);if($){var G=$[2]-1||0,X=($[7]||"0").substring(0,3);return M?new Date(Date.UTC($[1],G,$[3]||1,$[4]||0,$[5]||0,$[6]||0,X)):new Date($[1],G,$[3]||1,$[4]||0,$[5]||0,$[6]||0,X)}}return new Date(x)}(E),this.init()},O.init=function(){var E=this.$d;this.$y=E.getFullYear(),this.$M=E.getMonth(),this.$D=E.getDate(),this.$W=E.getDay(),this.$H=E.getHours(),this.$m=E.getMinutes(),this.$s=E.getSeconds(),this.$ms=E.getMilliseconds()},O.$utils=function(){return R},O.isValid=function(){return this.$d.toString()!==m},O.isSame=function(E,N){var x=P(E);return this.startOf(N)<=x&&x<=this.endOf(N)},O.isAfter=function(E,N){return P(E)<this.startOf(N)},O.isBefore=function(E,N){return this.endOf(N)<P(E)},O.$g=function(E,N,x){return R.u(E)?this[N]:this.set(x,E)},O.unix=function(){return Math.floor(this.valueOf()/1e3)},O.valueOf=function(){return this.$d.getTime()},O.startOf=function(E,N){var x=this,M=!!R.u(N)||N,$=R.p(E),G=function(Qe,ue){var Be=R.w(x.$u?Date.UTC(x.$y,ue,Qe):new Date(x.$y,ue,Qe),x);return M?Be:Be.endOf(l)},X=function(Qe,ue){return R.w(x.toDate()[Qe].apply(x.toDate("s"),(M?[0,0,0,0]:[23,59,59,999]).slice(ue)),x)},Z=this.$W,re=this.$M,pe=this.$D,ht="set"+(this.$u?"UTC":"");switch($){case h:return M?G(1,0):G(31,11);case u:return M?G(1,re):G(0,re+1);case d:var Je=this.$locale().weekStart||0,Dt=(Z<Je?Z+7:Z)-Je;return G(M?pe-Dt:pe+(6-Dt),re);case l:case g:return X(ht+"Hours",0);case c:return X(ht+"Minutes",1);case a:return X(ht+"Seconds",2);case o:return X(ht+"Milliseconds",3);default:return this.clone()}},O.endOf=function(E){return this.startOf(E,!1)},O.$set=function(E,N){var x,M=R.p(E),$="set"+(this.$u?"UTC":""),G=(x={},x[l]=$+"Date",x[g]=$+"Date",x[u]=$+"Month",x[h]=$+"FullYear",x[c]=$+"Hours",x[a]=$+"Minutes",x[o]=$+"Seconds",x[i]=$+"Milliseconds",x)[M],X=M===l?this.$D+(N-this.$W):N;if(M===u||M===h){var Z=this.clone().set(g,1);Z.$d[G](X),Z.init(),this.$d=Z.set(g,Math.min(this.$D,Z.daysInMonth())).$d}else G&&this.$d[G](X);return this.init(),this},O.set=function(E,N){return this.clone().$set(E,N)},O.get=function(E){return this[R.p(E)]()},O.add=function(E,N){var x,M=this;E=Number(E);var $=R.p(N),G=function(re){var pe=P(M);return R.w(pe.date(pe.date()+Math.round(re*E)),M)};if($===u)return this.set(u,this.$M+E);if($===h)return this.set(h,this.$y+E);if($===l)return G(1);if($===d)return G(7);var X=(x={},x[a]=r,x[c]=s,x[o]=n,x)[$]||1,Z=this.$d.getTime()+E*X;return R.w(Z,this)},O.subtract=function(E,N){return this.add(-1*E,N)},O.format=function(E){var N=this,x=this.$locale();if(!this.isValid())return x.invalidDate||m;var M=E||"YYYY-MM-DDTHH:mm:ssZ",$=R.z(this),G=this.$H,X=this.$m,Z=this.$M,re=x.weekdays,pe=x.months,ht=x.meridiem,Je=function(ue,Be,Nt,on){return ue&&(ue[Be]||ue(N,M))||Nt[Be].slice(0,on)},Dt=function(ue){return R.s(G%12||12,ue,"0")},Qe=ht||function(ue,Be,Nt){var on=ue<12?"AM":"PM";return Nt?on.toLowerCase():on};return M.replace(y,function(ue,Be){return Be||function(Nt){switch(Nt){case"YY":return String(N.$y).slice(-2);case"YYYY":return R.s(N.$y,4,"0");case"M":return Z+1;case"MM":return R.s(Z+1,2,"0");case"MMM":return Je(x.monthsShort,Z,pe,3);case"MMMM":return Je(pe,Z);case"D":return N.$D;case"DD":return R.s(N.$D,2,"0");case"d":return String(N.$W);case"dd":return Je(x.weekdaysMin,N.$W,re,2);case"ddd":return Je(x.weekdaysShort,N.$W,re,3);case"dddd":return re[N.$W];case"H":return String(G);case"HH":return R.s(G,2,"0");case"h":return Dt(1);case"hh":return Dt(2);case"a":return Qe(G,X,!0);case"A":return Qe(G,X,!1);case"m":return String(X);case"mm":return R.s(X,2,"0");case"s":return String(N.$s);case"ss":return R.s(N.$s,2,"0");case"SSS":return R.s(N.$ms,3,"0");case"Z":return $}return null}(ue)||$.replace(":","")})},O.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},O.diff=function(E,N,x){var M,$=this,G=R.p(N),X=P(E),Z=(X.utcOffset()-this.utcOffset())*r,re=this-X,pe=function(){return R.m($,X)};switch(G){case h:M=pe()/12;break;case u:M=pe();break;case f:M=pe()/3;break;case d:M=(re-Z)/6048e5;break;case l:M=(re-Z)/864e5;break;case c:M=re/s;break;case a:M=re/r;break;case o:M=re/n;break;default:M=re}return x?M:R.a(M)},O.daysInMonth=function(){return this.endOf(u).$D},O.$locale=function(){return k[this.$L]},O.locale=function(E,N){if(!E)return this.$L;var x=this.clone(),M=b(E,N,!0);return M&&(x.$L=M),x},O.clone=function(){return R.w(this.$d,this)},O.toDate=function(){return new Date(this.valueOf())},O.toJSON=function(){return this.isValid()?this.toISOString():null},O.toISOString=function(){return this.$d.toISOString()},O.toString=function(){return this.$d.toUTCString()},D}(),L=Y.prototype;return P.prototype=L,[["$ms",i],["$s",o],["$m",a],["$H",c],["$W",l],["$M",u],["$y",h],["$D",g]].forEach(function(D){L[D[1]]=function(O){return this.$g(O,D[0],D[1])}}),P.extend=function(D,O){return D.$i||(D(O,Y,P),D.$i=!0),P},P.locale=b,P.isDayjs=j,P.unix=function(D){return P(1e3*D)},P.en=k[T],P.Ls=k,P.p={},P})})(io);var xc=io.exports;const Kd=na(xc),oo=Object.prototype.toString;function ao(t){switch(oo.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return lt(t,Error)}}function Rt(t,e){return oo.call(t)===`[object ${e}]`}function ys(t){return Rt(t,"ErrorEvent")}function qs(t){return Rt(t,"DOMError")}function Tc(t){return Rt(t,"DOMException")}function ut(t){return Rt(t,"String")}function co(t){return t===null||typeof t!="object"&&typeof t!="function"}function Et(t){return Rt(t,"Object")}function Yn(t){return typeof Event<"u"&&lt(t,Event)}function Rc(t){return typeof Element<"u"&&lt(t,Element)}function Oc(t){return Rt(t,"RegExp")}function gs(t){return!!(t&&t.then&&typeof t.then=="function")}function Dc(t){return Et(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Nc(t){return typeof t=="number"&&t!==t}function lt(t,e){try{return t instanceof e}catch{return!1}}function uo(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function bt(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function Hs(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{uo(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function Ac(t,e,n=!1){return ut(t)?Oc(e)?e.test(t):ut(e)?n?t===e:t.includes(e):!1:!1}function qn(t,e=[],n=!1){return e.some(r=>Ac(t,r,n))}function Ic(t,e,n=250,r,s,i,o){if(!i.exception||!i.exception.values||!o||!lt(o.originalException,Error))return;const a=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;a&&(i.exception.values=Pc(Yr(t,e,s,o.originalException,r,i.exception.values,a,0),n))}function Yr(t,e,n,r,s,i,o,a){if(i.length>=n+1)return i;let c=[...i];if(lt(r[s],Error)){Gs(o,a);const l=t(e,r[s]),d=c.length;Ws(l,s,d,a),c=Yr(t,e,n,r[s],s,[l,...c],l,d)}return Array.isArray(r.errors)&&r.errors.forEach((l,d)=>{if(lt(l,Error)){Gs(o,a);const u=t(e,l),f=c.length;Ws(u,`errors[${d}]`,f,a),c=Yr(t,e,n,l,s,[u,...c],u,f)}}),c}function Gs(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function Ws(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function Pc(t,e){return t.map(n=>(n.value&&(n.value=bt(n.value,e)),n))}function pn(t){return t&&t.Math==Math?t:void 0}const te=typeof globalThis=="object"&&pn(globalThis)||typeof window=="object"&&pn(window)||typeof self=="object"&&pn(self)||typeof global=="object"&&pn(global)||function(){return this}()||{};function rn(){return te}function lo(t,e,n){const r=n||te,s=r.__SENTRY__=r.__SENTRY__||{};return s[t]||(s[t]=e())}const Cc=rn(),Mc=80;function qr(t,e={}){try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let l;const d=Array.isArray(e)?e:e.keyAttrs,u=!Array.isArray(e)&&e.maxStringLength||Mc;for(;n&&i++<r&&(l=Bc(n,d),!(l==="html"||i>1&&o+s.length*c+l.length>=u));)s.push(l),o+=l.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Bc(t,e){const n=t,r=[];let s,i,o,a,c;if(!n||!n.tagName)return"";r.push(n.tagName.toLowerCase());const l=e&&e.length?e.filter(u=>n.getAttribute(u)).map(u=>[u,n.getAttribute(u)]):null;if(l&&l.length)l.forEach(u=>{r.push(`[${u[0]}="${u[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),s=n.className,s&&ut(s))for(i=s.split(/\s+/),c=0;c<i.length;c++)r.push(`.${i[c]}`);const d=["aria-label","type","name","title","alt"];for(c=0;c<d.length;c++)o=d[c],a=n.getAttribute(o),a&&r.push(`[${o}="${a}"]`);return r.join("")}function $c(){try{return Cc.document.location.href}catch{return""}}const jc="Sentry Logger ",Hr=["debug","info","warn","error","log","assert","trace"],jn={};function fo(t){if(!("console"in te))return t();const e=te.console,n={},r=Object.keys(jn);r.forEach(s=>{const i=jn[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function Uc(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1}};return typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?Hr.forEach(n=>{e[n]=(...r)=>{t&&fo(()=>{te.console[n](`${jc}[${n}]:`,...r)})}}):Hr.forEach(n=>{e[n]=()=>{}}),e}const K=Uc(),Kc=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Fc(t){return t==="http"||t==="https"}function Hn(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function Lc(t){const e=Kc.exec(t);if(!e){console.error(`Invalid Sentry Dsn: ${t}`);return}const[n,r,s="",i,o="",a]=e.slice(1);let c="",l=a;const d=l.split("/");if(d.length>1&&(c=d.slice(0,-1).join("/"),l=d.pop()),l){const u=l.match(/^\d+/);u&&(l=u[0])}return ho({host:i,pass:s,path:c,projectId:l,port:o,protocol:n,publicKey:r})}function ho(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Yc(t){if(!(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__))return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(K.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Fc(r)?e&&isNaN(parseInt(e,10))?(K.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(K.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(K.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function qc(t){const e=typeof t=="string"?Lc(t):ho(t);if(!(!e||!Yc(e)))return e}class we extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function ne(t,e,n){if(!(e in t))return;const r=t[e],s=n(r);typeof s=="function"&&po(s,r),t[e]=s}function vs(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function po(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,vs(t,"__sentry_original__",e)}catch{}}function bs(t){return t.__sentry_original__}function Hc(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function mo(t){if(ao(t))return{message:t.message,name:t.name,stack:t.stack,...zs(t)};if(Yn(t)){const e={type:t.type,target:Vs(t.target),currentTarget:Vs(t.currentTarget),...zs(t)};return typeof CustomEvent<"u"&&lt(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function Vs(t){try{return Rc(t)?qr(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function zs(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function Gc(t,e=40){const n=Object.keys(mo(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return bt(n[0],e);for(let r=n.length;r>0;r--){const s=n.slice(0,r).join(", ");if(!(s.length>e))return r===n.length?s:bt(s,e)}return""}function Gn(t){return Gr(t,new Map)}function Gr(t,e){if(Et(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const s of Object.keys(t))typeof t[s]<"u"&&(r[s]=Gr(t[s],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(s=>{r.push(Gr(s,e))}),r}return t}const _o=50,Xs=/\(error: (.*)\)/,Js=/captureMessage|captureException/;function yo(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{const s=[],i=n.split(`
`);for(let o=r;o<i.length;o++){const a=i[o];if(a.length>1024)continue;const c=Xs.test(a)?a.replace(Xs,"$1"):a;if(!c.match(/\S*Error: /)){for(const l of e){const d=l(c);if(d){s.push(d);break}}if(s.length>=_o)break}}return Vc(s)}}function Wc(t){return Array.isArray(t)?yo(...t):t}function Vc(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),Js.test(e[e.length-1].function||"")&&(e.pop(),Js.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,_o).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const lr="<anonymous>";function Xe(t){try{return!t||typeof t!="function"?lr:t.name||lr}catch{return lr}}const Wr=rn();function go(){if(!("fetch"in Wr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Vr(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function zc(){if(!go())return!1;if(Vr(Wr.fetch))return!0;let t=!1;const e=Wr.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=Vr(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}const mn=rn();function Xc(){const t=mn.chrome,e=t&&t.app&&t.app.runtime,n="history"in mn&&!!mn.history.pushState&&!!mn.history.replaceState;return!e&&n}const ee=rn(),$t="__sentry_xhr_v2__",qt={},Qs={};function Jc(t){if(!Qs[t])switch(Qs[t]=!0,t){case"console":Qc();break;case"dom":ou();break;case"xhr":tu();break;case"fetch":Zc();break;case"history":nu();break;case"error":au();break;case"unhandledrejection":cu();break;default:(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("unknown instrumentation type:",t);return}}function qe(t,e){qt[t]=qt[t]||[],qt[t].push(e),Jc(t)}function ge(t,e){if(!(!t||!qt[t]))for(const n of qt[t]||[])try{n(e)}catch(r){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Xe(n)}
Error:`,r)}}function Qc(){"console"in te&&Hr.forEach(function(t){t in te.console&&ne(te.console,t,function(e){return jn[t]=e,function(...n){ge("console",{args:n,level:t});const r=jn[t];r&&r.apply(te.console,n)}})})}function Zc(){zc()&&ne(te,"fetch",function(t){return function(...e){const{method:n,url:r}=eu(e),s={args:e,fetchData:{method:n,url:r},startTimestamp:Date.now()};return ge("fetch",{...s}),t.apply(te,e).then(i=>(ge("fetch",{...s,endTimestamp:Date.now(),response:i}),i),i=>{throw ge("fetch",{...s,endTimestamp:Date.now(),error:i}),i})}})}function zr(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Zs(t){return typeof t=="string"?t:t?zr(t,"url")?t.url:t.toString?t.toString():"":""}function eu(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:Zs(n),method:zr(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:Zs(e),method:zr(e,"method")?String(e.method).toUpperCase():"GET"}}function tu(){if(!ee.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;ne(t,"open",function(e){return function(...n){const r=n[1],s=this[$t]={method:ut(n[0])?n[0].toUpperCase():n[0],url:n[1],request_headers:{}};ut(r)&&s.method==="POST"&&r.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const i=()=>{const o=this[$t];if(o&&this.readyState===4){try{o.status_code=this.status}catch{}ge("xhr",{args:n,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?ne(this,"onreadystatechange",function(o){return function(...a){return i(),o.apply(this,a)}}):this.addEventListener("readystatechange",i),ne(this,"setRequestHeader",function(o){return function(...a){const[c,l]=a,d=this[$t];return d&&(d.request_headers[c.toLowerCase()]=l),o.apply(this,a)}}),e.apply(this,n)}}),ne(t,"send",function(e){return function(...n){const r=this[$t];return r&&n[0]!==void 0&&(r.body=n[0]),ge("xhr",{args:n,startTimestamp:Date.now(),xhr:this}),e.apply(this,n)}})}let _n;function nu(){if(!Xc())return;const t=ee.onpopstate;ee.onpopstate=function(...n){const r=ee.location.href,s=_n;if(_n=r,ge("history",{from:s,to:r}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...r){const s=r.length>2?r[2]:void 0;if(s){const i=_n,o=String(s);_n=o,ge("history",{from:i,to:o})}return n.apply(this,r)}}ne(ee.history,"pushState",e),ne(ee.history,"replaceState",e)}const ru=1e3;let yn,gn;function su(t,e){if(!t||t.type!==e.type)return!0;try{if(t.target!==e.target)return!0}catch{}return!1}function iu(t){if(t.type!=="keypress")return!1;try{const e=t.target;if(!e||!e.tagName)return!0;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)return!1}catch{}return!0}function ei(t,e=!1){return n=>{if(!n||gn===n||iu(n))return;const r=n.type==="keypress"?"input":n.type;yn===void 0?(t({event:n,name:r,global:e}),gn=n):su(gn,n)&&(t({event:n,name:r,global:e}),gn=n),clearTimeout(yn),yn=ee.setTimeout(()=>{yn=void 0},ru)}}function ou(){if(!ee.document)return;const t=ge.bind(null,"dom"),e=ei(t,!0);ee.document.addEventListener("click",e,!1),ee.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=ee[n]&&ee[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(ne(r,"addEventListener",function(s){return function(i,o,a){if(i==="click"||i=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},d=l[i]=l[i]||{refCount:0};if(!d.handler){const u=ei(t);d.handler=u,s.call(this,i,u,a)}d.refCount++}catch{}return s.call(this,i,o,a)}}),ne(r,"removeEventListener",function(s){return function(i,o,a){if(i==="click"||i=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__||{},d=l[i];d&&(d.refCount--,d.refCount<=0&&(s.call(this,i,d.handler,a),d.handler=void 0,delete l[i]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return s.call(this,i,o,a)}}))})}let vn=null;function au(){vn=ee.onerror,ee.onerror=function(t,e,n,r,s){return ge("error",{column:r,error:s,line:n,msg:t,url:e}),vn&&!vn.__SENTRY_LOADER__?vn.apply(this,arguments):!1},ee.onerror.__SENTRY_INSTRUMENTED__=!0}let bn=null;function cu(){bn=ee.onunhandledrejection,ee.onunhandledrejection=function(t){return ge("unhandledrejection",t),bn&&!bn.__SENTRY_LOADER__?bn.apply(this,arguments):!0},ee.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function uu(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(s){if(t)return e.has(s)?!0:(e.add(s),!1);for(let i=0;i<e.length;i++)if(e[i]===s)return!0;return e.push(s),!1}function r(s){if(t)e.delete(s);else for(let i=0;i<e.length;i++)if(e[i]===s){e.splice(i,1);break}}return[n,r]}function Ge(){const t=te,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>e.getRandomValues(new Uint8Array(1))[0])}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function vo(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function He(t){const{message:e,event_id:n}=t;if(e)return e;const r=vo(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Xr(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type=n||"Error")}function Zt(t,e){const n=vo(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...r,...s,...e},e&&"data"in e){const i={...s&&s.data,...e.data};n.mechanism.data=i}}function ti(t){if(t&&t.__sentry_captured__)return!0;try{vs(t,"__sentry_captured__",!0)}catch{}return!1}function bo(t){return Array.isArray(t)?t:[t]}function lu(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function du(){return"npm"}function fu(){return!lu()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function hu(t,e){return t.require(e)}function Fe(t,e=100,n=1/0){try{return Jr("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function wo(t,e=3,n=100*1024){const r=Fe(t,e);return yu(r)>n?wo(t,e-1,n):r}function Jr(t,e,n=1/0,r=1/0,s=uu()){const[i,o]=s;if(e==null||["number","boolean","string"].includes(typeof e)&&!Nc(e))return e;const a=pu(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return Jr("",h,c-1,r,s)}catch{}const d=Array.isArray(e)?[]:{};let u=0;const f=mo(e);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(u>=r){d[h]="[MaxProperties ~]";break}const g=f[h];d[h]=Jr(h,g,c-1,r,s),u++}return o(e),d}function pu(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(uo(e))return"[VueViewModel]";if(Dc(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${Xe(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=mu(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function mu(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function _u(t){return~-encodeURI(t).split(/%..|./).length}function yu(t){return _u(JSON.stringify(t))}var Te;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(Te||(Te={}));function dt(t){return new fe(e=>{e(t)})}function ws(t){return new fe((e,n)=>{n(t)})}class fe{constructor(e){fe.prototype.__init.call(this),fe.prototype.__init2.call(this),fe.prototype.__init3.call(this),fe.prototype.__init4.call(this),this._state=Te.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new fe((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new fe((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}__init(){this._resolve=e=>{this._setResult(Te.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Te.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===Te.PENDING){if(gs(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Te.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Te.RESOLVED&&n[1](this._value),this._state===Te.REJECTED&&n[2](this._value),n[0]=!0)})}}}function gu(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]}function s(o){if(!n())return ws(new we("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function i(o){return new fe((a,c)=>{let l=e.length;if(!l)return a(!0);const d=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(u=>{dt(u).then(()=>{--l||(clearTimeout(d),a(!0))},c)})})}return{$:e,add:s,drain:i}}function dr(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const vu=["fatal","error","warning","log","info","debug"];function bu(t){return t==="warn"?"warning":vu.includes(t)?t:"log"}const Eo=rn(),Qr={nowSeconds:()=>Date.now()/1e3};function wu(){const{performance:t}=Eo;if(!t||!t.now)return;const e=Date.now()-t.now();return{now:()=>t.now(),timeOrigin:e}}function Eu(){try{return hu(module,"perf_hooks").performance}catch{return}}const fr=fu()?Eu():wu(),ni=fr===void 0?Qr:{nowSeconds:()=>(fr.timeOrigin+fr.now())/1e3},Wn=Qr.nowSeconds.bind(Qr),So=ni.nowSeconds.bind(ni);(()=>{const{performance:t}=Eo;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=t.timing&&t.timing.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,l=c<e;return i||l?s<=c?t.timeOrigin:o:r})();function sn(t,e=[]){return[t,e]}function Su(t,e){const[n,r]=t;return[n,[...r,e]]}function ri(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function Zr(t,e){return(e||new TextEncoder).encode(t)}function ku(t,e){const[n,r]=t;let s=JSON.stringify(n);function i(o){typeof s=="string"?s=typeof o=="string"?s+o:[Zr(s,e),o]:s.push(typeof o=="string"?Zr(o,e):o)}for(const o of r){const[a,c]=o;if(i(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)i(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(Fe(c))}i(l)}}return typeof s=="string"?s:xu(s)}function xu(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Tu(t,e){const n=typeof t.data=="string"?Zr(t.data,e):t.data;return[Gn({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const Ru={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function si(t){return Ru[t]}function ko(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function Ou(t,e,n,r){const s=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:Hn(r)},...s&&{trace:Gn({...s})}}}function Du(t,e,n){const r=[{type:"client_report"},{timestamp:n||Wn(),discarded_events:t}];return sn(e?{dsn:e}:{},[r])}const Nu=60*1e3;function Au(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?Nu:r-e}function Iu(t,e){return t[e]||t.all||0}function Pu(t,e,n=Date.now()){return Iu(t,e)>n}function Cu(t,{statusCode:e,headers:n},r=Date.now()){const s={...t},i=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(i)for(const a of i.trim().split(",")){const[c,l]=a.split(":",2),d=parseInt(c,10),u=(isNaN(d)?60:d)*1e3;if(!l)s.all=r+u;else for(const f of l.split(";"))s[f]=r+u}else o?s.all=r+Au(o,r):e===429&&(s.all=r+60*1e3);return s}const Es="production";function Ss(){return lo("globalEventProcessors",()=>[])}function Mu(t){Ss().push(t)}function Un(t,e,n,r=0){return new fe((s,i)=>{const o=t[r];if(e===null||typeof o!="function")s(e);else{const a=o({...e},n);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&o.id&&a===null&&K.log(`Event processor "${o.id}" dropped event`),gs(a)?a.then(c=>Un(t,c,n,r+1).then(s)).then(null,i):Un(t,a,n,r+1).then(s).then(null,i)}})}function Bu(t){const e=So(),n={sid:Ge(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>ju(n)};return t&&St(n,t),n}function St(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||So(),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Ge()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function $u(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),St(t,n)}function ju(t){return Gn({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}const Uu=100;class ot{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=ii()}static clone(e){const n=new ot;return e&&(n._breadcrumbs=[...e._breadcrumbs],n._tags={...e._tags},n._extra={...e._extra},n._contexts={...e._contexts},n._user=e._user,n._level=e._level,n._span=e._span,n._session=e._session,n._transactionName=e._transactionName,n._fingerprint=e._fingerprint,n._eventProcessors=[...e._eventProcessors],n._requestSession=e._requestSession,n._attachments=[...e._attachments],n._sdkProcessingMetadata={...e._sdkProcessingMetadata},n._propagationContext={...e._propagationContext}),n}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&St(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof ot?n:this}return e instanceof ot?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Et(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=ii(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:Uu;if(r<=0)return this;const s={timestamp:Wn(),...e},i=this._breadcrumbs;return i.push(s),this._breadcrumbs=i.length>r?i.slice(-r):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,n={},r){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};const o=this._span.transaction;if(o){e.sdkProcessingMetadata={dynamicSamplingContext:o.getDynamicSamplingContext(),...e.sdkProcessingMetadata};const a=o.name;a&&(e.tags={transaction:a,...e.tags})}}this._applyFingerprint(e);const s=this._getBreadcrumbs(),i=[...e.breadcrumbs||[],...s];return e.breadcrumbs=i.length>0?i:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},Un([...r||[],...Ss(),...this._eventProcessors],e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_getBreadcrumbs(){return this._breadcrumbs}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}_applyFingerprint(e){e.fingerprint=e.fingerprint?bo(e.fingerprint):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}function ii(){return{traceId:Ge(),spanId:Ge().substring(16)}}const xo=4,Ku=100;class To{constructor(e,n=new ot,r=xo){this._version=r,this._stack=[{scope:n}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=ot.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();try{e(n)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Ge(),s=new Error("Sentry syntheticException");return this._withClient((i,o)=>{i.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},o)}),r}captureMessage(e,n,r){const s=this._lastEventId=r&&r.event_id?r.event_id:Ge(),i=new Error(e);return this._withClient((o,a)=>{o.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},a)}),s}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Ge();return e.type||(this._lastEventId=r),this._withClient((s,i)=>{s.captureEvent(e,{...n,event_id:r},i)}),r}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:r,client:s}=this.getStackTop();if(!s)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:o=Ku}=s.getOptions&&s.getOptions()||{};if(o<=0)return;const c={timestamp:Wn(),...e},l=i?fo(()=>i(c,n)):c;l!==null&&(s.emit&&s.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,o))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n)}configureScope(e){const{scope:n,client:r}=this.getStackTop();r&&e(n)}run(e){const n=oi(this);try{e(this)}finally{oi(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const r=this._callExtensionMethod("startTransaction",e,n);if((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&!r){const s=this.getClient();console.warn(s?`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`:"Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")}return r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&$u(r),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:r}=this.getStackTop(),{release:s,environment:i=Es}=r&&r.getOptions()||{},{userAgent:o}=te.navigator||{},a=Bu({release:s,environment:i,user:n.getUser(),...o&&{userAgent:o},...e}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&St(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),r=e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_withClient(e){const{scope:n,client:r}=this.getStackTop();r&&e(r,n)}_callExtensionMethod(e,...n){const s=Vn().__SENTRY__;if(s&&s.extensions&&typeof s.extensions[e]=="function")return s.extensions[e].apply(this,n);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Vn(){return te.__SENTRY__=te.__SENTRY__||{extensions:{},hub:void 0},te}function oi(t){const e=Vn(),n=es(e);return Ro(e,t),n}function oe(){const t=Vn();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return Fu(t)}function Fu(t=Vn()){return(!Lu(t)||es(t).isOlderThan(xo))&&Ro(t,new To),es(t)}function Lu(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function es(t){return lo("hub",()=>new To,t)}function Ro(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function Yu(t,e,n){const r=e.getOptions(),{publicKey:s}=e.getDsn()||{},{segment:i}=n&&n.getUser()||{},o=Gn({environment:r.environment||Es,release:r.release,user_segment:i,public_key:s,trace_id:t});return e.emit&&e.emit("createDsc",o),o}function Oo(t,e){return oe().captureException(t,{captureContext:e})}function qu(t){oe().withScope(t)}const Hu="7";function Gu(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function Wu(t){return`${Gu(t)}${t.projectId}/envelope/`}function Vu(t,e){return Hc({sentry_key:t.publicKey,sentry_version:Hu,...e&&{sentry_client:`${e.name}/${e.version}`}})}function zu(t,e={}){const n=typeof e=="string"?e:e.tunnel,r=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${Wu(t)}?${Vu(t,r)}`}function Xu(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function Ju(t,e,n,r){const s=ko(n),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!r&&e&&{dsn:Hn(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return sn(i,[o])}function Qu(t,e,n,r){const s=ko(n),i=t.type&&t.type!=="replay_event"?t.type:"event";Xu(t,n&&n.sdk);const o=Ou(t,s,r,e);return delete t.sdkProcessingMetadata,sn(o,[[{type:i},t]])}const ai=[];function Zu(t){const e={};return t.forEach(n=>{const{name:r}=n,s=e[r];s&&!s.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.keys(e).map(n=>e[n])}function el(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...e,...n]:typeof n=="function"?r=bo(n(e)):r=e;const s=Zu(r),i=nl(s,o=>o.name==="Debug");if(i!==-1){const[o]=s.splice(i,1);s.push(o)}return s}function tl(t,e){const n={};return e.forEach(r=>{r&&Do(t,r,n)}),n}function Do(t,e,n){if(n[e.name]=e,ai.indexOf(e.name)===-1&&(e.setupOnce(Mu,oe),ai.push(e.name)),t.on&&typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log(`Integration installed: ${e.name}`)}function nl(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}function rl(t,e,n,r,s){const{normalizeDepth:i=3,normalizeMaxBreadth:o=1e3}=t,a={...e,event_id:e.event_id||n.event_id||Ge(),timestamp:e.timestamp||Wn()},c=n.integrations||t.integrations.map(f=>f.name);sl(a,t),al(a,c),e.type===void 0&&il(a,t.stackParser);let l=r;n.captureContext&&(l=ot.clone(l).update(n.captureContext));let d=dt(a);const u=s&&s.getEventProcessors?s.getEventProcessors():[];if(l){if(l.getAttachments){const f=[...n.attachments||[],...l.getAttachments()];f.length&&(n.attachments=f)}d=l.applyToEvent(a,n,u)}else d=Un([...u,...Ss()],a,n);return d.then(f=>(f&&ol(f),typeof i=="number"&&i>0?cl(f,i,o):f))}function sl(t,e){const{environment:n,release:r,dist:s,maxValueLength:i=250}=e;"environment"in t||(t.environment="environment"in e?n:Es),t.release===void 0&&r!==void 0&&(t.release=r),t.dist===void 0&&s!==void 0&&(t.dist=s),t.message&&(t.message=bt(t.message,i));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=bt(o.value,i));const a=t.request;a&&a.url&&(a.url=bt(a.url,i))}const ci=new WeakMap;function il(t,e){const n=te._sentryDebugIds;if(!n)return;let r;const s=ci.get(e);s?r=s:(r=new Map,ci.set(e,r));const i=Object.keys(n).reduce((o,a)=>{let c;const l=r.get(a);l?c=l:(c=e(a),r.set(a,c));for(let d=c.length-1;d>=0;d--){const u=c[d];if(u.filename){o[u.filename]=n[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=i[a.filename])})})}catch{}}function ol(t){const e={};try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(s=>{s.debug_id&&(s.abs_path?e[s.abs_path]=s.debug_id:s.filename&&(e[s.filename]=s.debug_id),delete s.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:e[r]})})}function al(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function cl(t,e,n){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(s=>({...s,...s.data&&{data:Fe(s.data,e,n)}}))},...t.user&&{user:Fe(t.user,e,n)},...t.contexts&&{contexts:Fe(t.contexts,e,n)},...t.extra&&{extra:Fe(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Fe(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(s=>(s.data&&(s.data=Fe(s.data,e,n)),s))),r}const ui="Not capturing exception because it's already been captured.";class ul{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=qc(e.dsn):(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("No DSN provided, client will not send events."),this._dsn){const n=zu(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){if(ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log(ui);return}let s=n&&n.event_id;return this._process(this.eventFromException(e,n).then(i=>this._captureEvent(i,n,r)).then(i=>{s=i})),s}captureMessage(e,n,r,s){let i=r&&r.event_id;const o=co(e)?this.eventFromMessage(String(e),n,r):this.eventFromException(e,r);return this._process(o.then(a=>this._captureEvent(a,r,s)).then(a=>{i=a})),i}captureEvent(e,n,r){if(n&&n.originalException&&ti(n.originalException)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log(ui);return}let s=n&&n.event_id;return this._process(this._captureEvent(e,n,r).then(i=>{s=i})),s}captureSession(e){typeof e.release!="string"?(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),St(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?this._isClientDoneProcessing(e).then(r=>n.flush(e).then(s=>r&&s)):dt(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&(this._integrations=tl(this,this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){Do(this,e,this._integrations)}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=Qu(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of n.attachments||[])r=Su(r,Tu(i,this._options.transportOptions&&this._options.transportOptions.textEncoder));const s=this._sendEnvelope(r);s&&s.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const n=Ju(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const s=`${e}:${n}`;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log(`Adding outcome: "${s}"`),this._outcomes[s]=this._outcomes[s]+1||1}}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(r=>r(...n))}_updateSessionFromEvent(e,n){let r=!1,s=!1;const i=n.exception&&n.exception.values;if(i){s=!0;for(const c of i){const l=c.mechanism;if(l&&l.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(St(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new fe(n=>{let r=0;const s=1,i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=s,e&&r>=e&&(clearInterval(i),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r){const s=this.getOptions(),i=Object.keys(this._integrations);return!n.integrations&&i.length>0&&(n.integrations=i),this.emit("preprocessEvent",e,n),rl(s,e,n,r,this).then(o=>{if(o===null)return o;const{propagationContext:a}=o.sdkProcessingMetadata||{};if(!(o.contexts&&o.contexts.trace)&&a){const{traceId:l,spanId:d,parentSpanId:u,dsc:f}=a;o.contexts={trace:{trace_id:l,span_id:d,parent_span_id:u},...o.contexts};const h=f||Yu(l,this,r);o.sdkProcessingMetadata={dynamicSamplingContext:h,...o.sdkProcessingMetadata}}return o})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(s=>s.event_id,s=>{if(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__){const i=s;i.logLevel==="log"?K.log(i.message):K.warn(i)}})}_processEvent(e,n,r){const s=this.getOptions(),{sampleRate:i}=s,o=Ao(e),a=No(e),c=e.type||"error",l=`before send for type \`${c}\``;if(a&&typeof i=="number"&&Math.random()>i)return this.recordDroppedEvent("sample_rate","error",e),ws(new we(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const d=c==="replay_event"?"replay":c;return this._prepareEvent(e,n,r).then(u=>{if(u===null)throw this.recordDroppedEvent("event_processor",d,e),new we("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return u;const h=dl(s,u,n);return ll(h,l)}).then(u=>{if(u===null)throw this.recordDroppedEvent("before_send",d,e),new we(`${l} returned \`null\`, will not send event.`,"log");const f=r&&r.getSession();!o&&f&&this._updateSessionFromEvent(f,u);const h=u.transaction_info;if(o&&h&&u.transaction!==e.transaction){const g="custom";u.transaction_info={...h,source:g}}return this.sendEvent(u,n),u}).then(null,u=>{throw u instanceof we?u:(this.captureException(u,{data:{__sentry__:!0},originalException:u}),new we(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${u}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.error("Error while sending event:",n)});(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[r,s]=n.split(":");return{reason:r,category:s,quantity:e[n]}})}}function ll(t,e){const n=`${e} must return \`null\` or a valid event.`;if(gs(t))return t.then(r=>{if(!Et(r)&&r!==null)throw new we(n);return r},r=>{throw new we(`${e} rejected with ${r}`)});if(!Et(t)&&t!==null)throw new we(n);return t}function dl(t,e,n){const{beforeSend:r,beforeSendTransaction:s}=t;return No(e)&&r?r(e,n):Ao(e)&&s?s(e,n):e}function No(t){return t.type===void 0}function Ao(t){return t.type==="transaction"}function fl(t,e){e.debug===!0&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?K.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const n=oe();n.getScope().update(e.initialScope);const s=new t(e);n.bindClient(s)}const hl=30;function Io(t,e,n=gu(t.bufferSize||hl)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(ri(o,(u,f)=>{const h=si(f);if(Pu(r,h)){const g=li(u,f);t.recordDroppedEvent("ratelimit_backoff",h,g)}else a.push(u)}),a.length===0)return dt();const c=sn(o[0],a),l=u=>{ri(c,(f,h)=>{const g=li(f,h);t.recordDroppedEvent(u,si(h),g)})},d=()=>e({body:ku(c,t.textEncoder)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),r=Cu(r,u),u),u=>{throw l("network_error"),u});return n.add(d).then(u=>u,u=>{if(u instanceof we)return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.error("Skipped sending event because buffer is full."),l("queue_overflow"),dt();throw u})}return i.__sentry__baseTransport__=!0,{send:i,flush:s}}function li(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}const di="7.73.0";let fi;class zn{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=zn.id}setupOnce(){fi=Function.prototype.toString;try{Function.prototype.toString=function(...e){const n=bs(this)||this;return fi.apply(n,e)}}catch{}}}zn.__initStatic();const pl=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],ml=[/^.*healthcheck.*$/,/^.*healthy.*$/,/^.*live.*$/,/^.*ready.*$/,/^.*heartbeat.*$/,/^.*\/health$/,/^.*\/healthz$/];class Xn{static __initStatic(){this.id="InboundFilters"}constructor(e={}){this.name=Xn.id,this._options=e}setupOnce(e,n){}processEvent(e,n,r){const s=r.getOptions(),i=_l(this._options,s);return yl(e,i)?null:e}}Xn.__initStatic();function _l(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:pl],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:ml],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function yl(t,e){return e.ignoreInternal&&Sl(t)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Event dropped due to being internal Sentry Error.
Event: ${He(t)}`),!0):gl(t,e.ignoreErrors)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${He(t)}`),!0):vl(t,e.ignoreTransactions)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${He(t)}`),!0):bl(t,e.denyUrls)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${He(t)}.
Url: ${Kn(t)}`),!0):wl(t,e.allowUrls)?!1:((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${He(t)}.
Url: ${Kn(t)}`),!0)}function gl(t,e){return t.type||!e||!e.length?!1:El(t).some(n=>qn(n,e))}function vl(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?qn(n,e):!1}function bl(t,e){if(!e||!e.length)return!1;const n=Kn(t);return n?qn(n,e):!1}function wl(t,e){if(!e||!e.length)return!0;const n=Kn(t);return n?qn(n,e):!0}function El(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&e.length===0&&K.error(`Could not extract message for event ${He(t)}`),e}function Sl(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function kl(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Kn(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?kl(e):null}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.error(`Cannot extract url for event ${He(t)}`),null}}const H=te;let ts=0;function Po(){return ts>0}function xl(){ts++,setTimeout(()=>{ts--})}function kt(t,e={},n){if(typeof t!="function")return t;try{const s=t.__sentry_wrapped__;if(s)return s;if(bs(t))return t}catch{return t}const r=function(){const s=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const i=s.map(o=>kt(o,e));return t.apply(this,i)}catch(i){throw xl(),qu(o=>{o.addEventProcessor(a=>(e.mechanism&&(Xr(a,void 0,void 0),Zt(a,e.mechanism)),a.extra={...a.extra,arguments:s},a)),Oo(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch{}po(r,t),vs(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}function Co(t,e){const n=ks(t,e),r={type:e&&e.name,value:Dl(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function Tl(t,e,n,r){const i=oe().getClient(),o=i&&i.getOptions().normalizeDepth,a={exception:{values:[{type:Yn(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:Il(e,{isUnhandledRejection:r})}]},extra:{__serialized__:wo(e,o)}};if(n){const c=ks(t,n);c.length&&(a.exception.values[0].stacktrace={frames:c})}return a}function hr(t,e){return{exception:{values:[Co(t,e)]}}}function ks(t,e){const n=e.stacktrace||e.stack||"",r=Ol(e);try{return t(n,r)}catch{}return[]}const Rl=/Minified React error #\d+;/i;function Ol(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(Rl.test(t.message))return 1}return 0}function Dl(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function Nl(t,e,n,r){const s=n&&n.syntheticException||void 0,i=xs(t,e,s,r);return Zt(i),i.level="error",n&&n.event_id&&(i.event_id=n.event_id),dt(i)}function Al(t,e,n="info",r,s){const i=r&&r.syntheticException||void 0,o=ns(t,e,i,s);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),dt(o)}function xs(t,e,n,r,s){let i;if(ys(e)&&e.error)return hr(t,e.error);if(qs(e)||Tc(e)){const o=e;if("stack"in e)i=hr(t,e);else{const a=o.name||(qs(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;i=ns(t,c,n,r),Xr(i,c)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}return ao(e)?hr(t,e):Et(e)||Yn(e)?(i=Tl(t,e,n,s),Zt(i,{synthetic:!0}),i):(i=ns(t,e,n,r),Xr(i,`${e}`,void 0),Zt(i,{synthetic:!0}),i)}function ns(t,e,n,r){const s={message:e};if(r&&n){const i=ks(t,n);i.length&&(s.exception={values:[{value:e,stacktrace:{frames:i}}]})}return s}function Il(t,{isUnhandledRejection:e}){const n=Gc(t),r=e?"promise rejection":"exception";return ys(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Yn(t)?`Event \`${Pl(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function Pl(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function Cl(t,{metadata:e,tunnel:n,dsn:r}){const s={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!r&&{dsn:Hn(r)}},i=Ml(t);return sn(s,[i])}function Ml(t){return[{type:"user_report"},t]}class Bl extends ul{constructor(e){const n=H.SENTRY_SDK_SOURCE||du();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${n}:@sentry/browser`,version:di}],version:di},super(e),e.sendClientReports&&H.document&&H.document.addEventListener("visibilitychange",()=>{H.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return Nl(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return Al(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("SDK not enabled, will not capture user feedback.");return}const n=Cl(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log("No outcomes to send");return}if(!this._dsn){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log("No dsn provided, will not send outcomes");return}(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log("Sending outcomes:",e);const n=Du(e,this._options.tunnel&&Hn(this._dsn));this._sendEnvelope(n)}}let jt;function $l(){if(jt)return jt;if(Vr(H.fetch))return jt=H.fetch.bind(H);const t=H.document;let e=H.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(e=r.fetch),t.head.removeChild(n)}catch(n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return jt=e.bind(H)}function jl(){jt=void 0}function Ul(t,e=$l()){let n=0,r=0;function s(i){const o=i.body.length;n+=o,r++;const a={body:i.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return jl(),n-=o,r--,ws(c)}}return Io(t,s)}const Kl=4;function Fl(t){function e(n){return new fe((r,s)=>{const i=new XMLHttpRequest;i.onerror=s,i.onreadystatechange=()=>{i.readyState===Kl&&r({statusCode:i.status,headers:{"x-sentry-rate-limits":i.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":i.getResponseHeader("Retry-After")}})},i.open("POST",t.url);for(const o in t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&i.setRequestHeader(o,t.headers[o]);i.send(n.body)})}return Io(t,e)}const Jn="?",Ll=30,Yl=40,ql=50;function Ts(t,e,n,r){const s={filename:t,function:e,in_app:!0};return n!==void 0&&(s.lineno=n),r!==void 0&&(s.colno=r),s}const Hl=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Gl=/\((\S*)(?::(\d+))(?::(\d+))\)/,Wl=t=>{const e=Hl.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const i=Gl.exec(e[2]);i&&(e[2]=i[1],e[3]=i[2],e[4]=i[3])}const[r,s]=Mo(e[1]||Jn,e[2]);return Ts(s,r,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},Vl=[Ll,Wl],zl=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Xl=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Jl=t=>{const e=zl.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=Xl.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let r=e[3],s=e[1]||Jn;return[s,r]=Mo(s,r),Ts(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Ql=[ql,Jl],Zl=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,ed=t=>{const e=Zl.exec(t);return e?Ts(e[2],e[1]||Jn,+e[3],e[4]?+e[4]:void 0):void 0},td=[Yl,ed],nd=[Vl,Ql,td],rd=yo(...nd),Mo=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Jn,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]};class Ot{static __initStatic(){this.id="GlobalHandlers"}constructor(e){this.name=Ot.id,this._options={onerror:!0,onunhandledrejection:!0,...e},this._installFunc={onerror:sd,onunhandledrejection:id}}setupOnce(){Error.stackTraceLimit=50;const e=this._options;for(const n in e){const r=this._installFunc[n];r&&e[n]&&(cd(n),r(),this._installFunc[n]=void 0)}}}Ot.__initStatic();function sd(){qe("error",t=>{const[e,n,r]=jo();if(!e.getIntegration(Ot))return;const{msg:s,url:i,line:o,column:a,error:c}=t;if(Po()||c&&c.__sentry_own_request__)return;const l=c===void 0&&ut(s)?ad(s,i,o,a):Bo(xs(n,c||s,void 0,r,!1),i,o,a);l.level="error",$o(e,c,l,"onerror")})}function id(){qe("unhandledrejection",t=>{const[e,n,r]=jo();if(!e.getIntegration(Ot))return;let s=t;try{"reason"in t?s=t.reason:"detail"in t&&"reason"in t.detail&&(s=t.detail.reason)}catch{}if(Po()||s&&s.__sentry_own_request__)return!0;const i=co(s)?od(s):xs(n,s,void 0,r,!0);i.level="error",$o(e,s,i,"onunhandledrejection")})}function od(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function ad(t,e,n,r){const s=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let i=ys(t)?t.message:t,o="Error";const a=i.match(s);return a&&(o=a[1],i=a[2]),Bo({exception:{values:[{type:o,value:i}]}},e,n,r)}function Bo(t,e,n,r){const s=t.exception=t.exception||{},i=s.values=s.values||[],o=i[0]=i[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,d=isNaN(parseInt(n,10))?void 0:n,u=ut(e)&&e.length>0?e:$c();return c.length===0&&c.push({colno:l,filename:u,function:"?",in_app:!0,lineno:d}),t}function cd(t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.log(`Global Handler attached: ${t}`)}function $o(t,e,n,r){Zt(n,{handled:!1,type:r}),t.captureEvent(n,{originalException:e})}function jo(){const t=oe(),e=t.getClient(),n=e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[t,n.stackParser,n.attachStacktrace]}const ud=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Qn{static __initStatic(){this.id="TryCatch"}constructor(e){this.name=Qn.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e}}setupOnce(){this._options.setTimeout&&ne(H,"setTimeout",hi),this._options.setInterval&&ne(H,"setInterval",hi),this._options.requestAnimationFrame&&ne(H,"requestAnimationFrame",ld),this._options.XMLHttpRequest&&"XMLHttpRequest"in H&&ne(XMLHttpRequest.prototype,"send",dd);const e=this._options.eventTarget;e&&(Array.isArray(e)?e:ud).forEach(fd)}}Qn.__initStatic();function hi(t){return function(...e){const n=e[0];return e[0]=kt(n,{mechanism:{data:{function:Xe(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function ld(t){return function(e){return t.apply(this,[kt(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Xe(t)},handled:!1,type:"instrument"}})])}}function dd(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&ne(n,s,function(i){const o={mechanism:{data:{function:s,handler:Xe(i)},handled:!1,type:"instrument"}},a=bs(i);return a&&(o.mechanism.data.handler=Xe(a)),kt(i,o)})}),t.apply(this,e)}}function fd(t){const e=H,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(ne(n,"addEventListener",function(r){return function(s,i,o){try{typeof i.handleEvent=="function"&&(i.handleEvent=kt(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Xe(i),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[s,kt(i,{mechanism:{data:{function:"addEventListener",handler:Xe(i),target:t},handled:!1,type:"instrument"}}),o])}}),ne(n,"removeEventListener",function(r){return function(s,i,o){const a=i;try{const c=a&&a.__sentry_wrapped__;c&&r.call(this,s,c,o)}catch{}return r.call(this,s,a,o)}}))}const wn=1024;class Zn{static __initStatic(){this.id="Breadcrumbs"}constructor(e){this.name=Zn.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e}}setupOnce(){if(this.options.console&&qe("console",md),this.options.dom&&qe("dom",pd(this.options.dom)),this.options.xhr&&qe("xhr",_d),this.options.fetch&&qe("fetch",yd),this.options.history&&qe("history",gd),this.options.sentry){const e=oe().getClient();e&&e.on&&e.on("beforeSendEvent",hd)}}}Zn.__initStatic();function hd(t){oe().addBreadcrumb({category:`sentry.${t.type==="transaction"?"transaction":"event"}`,event_id:t.event_id,level:t.level,message:He(t)},{event:t})}function pd(t){function e(n){let r,s=typeof t=="object"?t.serializeAttribute:void 0,i=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;i&&i>wn&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn(`\`dom.maxStringLength\` cannot exceed ${wn}, but a value of ${i} was configured. Sentry will use ${wn} instead.`),i=wn),typeof s=="string"&&(s=[s]);try{const o=n.event;r=vd(o)?qr(o.target,{keyAttrs:s,maxStringLength:i}):qr(o,{keyAttrs:s,maxStringLength:i})}catch{r="<unknown>"}r.length!==0&&oe().addBreadcrumb({category:`ui.${n.name}`,message:r},{event:n.event,name:n.name,global:n.global})}return e}function md(t){const e={category:"console",data:{arguments:t.args,logger:"console"},level:bu(t.level),message:Hs(t.args," ")};if(t.level==="assert")if(t.args[0]===!1)e.message=`Assertion failed: ${Hs(t.args.slice(1)," ")||"console.assert"}`,e.data.arguments=t.args.slice(1);else return;oe().addBreadcrumb(e,{input:t.args,level:t.level})}function _d(t){const{startTimestamp:e,endTimestamp:n}=t,r=t.xhr[$t];if(!e||!n||!r)return;const{method:s,url:i,status_code:o,body:a}=r,c={method:s,url:i,status_code:o},l={xhr:t.xhr,input:a,startTimestamp:e,endTimestamp:n};oe().addBreadcrumb({category:"xhr",data:c,type:"http"},l)}function yd(t){const{startTimestamp:e,endTimestamp:n}=t;if(n&&!(t.fetchData.url.match(/sentry_key/)&&t.fetchData.method==="POST"))if(t.error){const r=t.fetchData,s={data:t.error,input:t.args,startTimestamp:e,endTimestamp:n};oe().addBreadcrumb({category:"fetch",data:r,level:"error",type:"http"},s)}else{const r={...t.fetchData,status_code:t.response&&t.response.status},s={input:t.args,response:t.response,startTimestamp:e,endTimestamp:n};oe().addBreadcrumb({category:"fetch",data:r,type:"http"},s)}}function gd(t){let e=t.from,n=t.to;const r=dr(H.location.href);let s=dr(e);const i=dr(n);s.path||(s=r),r.protocol===i.protocol&&r.host===i.host&&(n=i.relative),r.protocol===s.protocol&&r.host===s.host&&(e=s.relative),oe().addBreadcrumb({category:"navigation",data:{from:e,to:n}})}function vd(t){return!!t&&!!t.target}const bd="cause",wd=5;class er{static __initStatic(){this.id="LinkedErrors"}constructor(e={}){this.name=er.id,this._key=e.key||bd,this._limit=e.limit||wd}setupOnce(){}preprocessEvent(e,n,r){const s=r.getOptions();Ic(Co,s.stackParser,s.maxValueLength,this._key,this._limit,e,n)}}er.__initStatic();class tr{static __initStatic(){this.id="HttpContext"}constructor(){this.name=tr.id}setupOnce(){}preprocessEvent(e){if(!H.navigator&&!H.location&&!H.document)return;const n=e.request&&e.request.url||H.location&&H.location.href,{referrer:r}=H.document||{},{userAgent:s}=H.navigator||{},i={...e.request&&e.request.headers,...r&&{Referer:r},...s&&{"User-Agent":s}},o={...e.request,...n&&{url:n},headers:i};e.request=o}}tr.__initStatic();class nr{static __initStatic(){this.id="Dedupe"}constructor(){this.name=nr.id}setupOnce(e,n){}processEvent(e){if(e.type)return e;try{if(Ed(e,this._previousEvent))return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return this._previousEvent=e}}nr.__initStatic();function Ed(t,e){return e?!!(Sd(t,e)||kd(t,e)):!1}function Sd(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!Ko(t,e)||!Uo(t,e))}function kd(t,e){const n=pi(e),r=pi(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!Ko(t,e)||!Uo(t,e))}function Uo(t,e){let n=mi(t),r=mi(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let s=0;s<r.length;s++){const i=r[s],o=n[s];if(i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1}return!0}function Ko(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function pi(t){return t.exception&&t.exception.values&&t.exception.values[0]}function mi(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const xd=[new Xn,new zn,new Qn,new Zn,new Ot,new er,new nr,new tr];function Td(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=xd),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),H.SENTRY_RELEASE&&H.SENTRY_RELEASE.id&&(t.release=H.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:Wc(t.stackParser||rd),integrations:el(t),transport:t.transport||(go()?Ul:Fl)};fl(Bl,e),t.autoSessionTracking&&Rd()}function _i(t){t.startSession({ignoreDuration:!0}),t.captureSession()}function Rd(){if(typeof H.document>"u"){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&K.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const t=oe();t.captureSession&&(_i(t),qe("history",({from:e,to:n})=>{e===void 0||e===n||_i(oe())}))}function Od(t){return{...t,timestamp:Date.now(),id:yi()}}function Dd(t){let e=t;return t.error&&"stack"in t.error?(e=new Error(t.error.message),e.stack=t.error.stack):t.reactError&&(e=new Error("React Error"),e.stack=t.reactError.componentStack),e}class Fo{static async reportErrors(){const e=await this.getErrors();Td({release:ra,dsn:sa,environment:"production"}),e.forEach(n=>{Oo(Dd(n),{extra:n})})}static saveError({error:e,reactError:n}){const r=Od({error:{...e},reactError:{...n}});return p.errors.add(r)}static async checkForErrors(){return(await this.getErrors()).length>0}static async getErrors(){return p.errors.toArray()}static async clearErrors(){await p.errors.clear()}}globalThis.addEventListener("error",t=>{typeof window<"u"||t?.error&&Fo.saveError({error:{message:t?.error?.message,stack:t?.error?.stack}})});function Fd(t){try{return t()}catch(e){throw Fo.saveError({error:e}),e}}class rs{static async upsertAsset(e){return p.transaction("rw!",p.assets,async()=>{const{assetId:n,...r}=e.data;return await p.assets.get({assetId:n})?await p.assets.update(n,r):await p.assets.add(e.data),p.assets.get({assetId:n})})}static updateAsset(e){if(!e.data)throw new Error("Asset.data undefined");if(!e.id)throw new Error("Asset.id undefined");return p.transaction("rw",p.assets,async()=>(await p.assets.update(e.id,e.data),p.assets.get(e.id)))}static async addAsset(e){return p.transaction("rw",p.assets,async()=>(await p.assets.add(e.data),p.assets.get({assetId:e.data.assetId})))}static async addAssets(e){return p.transaction("rw",p.assets,async()=>(await p.assets.bulkAdd(e.data),!0))}static async removeAsset({assetId:e}){return p.transaction("rw",p.assets,async()=>(await p.assets.delete(e),!0))}static async getAsset(e){return p.transaction("r",p.assets,async()=>p.assets.get({assetId:e}))}static async clearAssets(){return p.transaction("rw",p.assets,async()=>p.assets.clear())}static async getAssets(){return p.transaction("r",p.assets,async()=>p.assets.toArray())}static async getAssetsByFilter(e){return p.transaction("r",p.assets,async()=>p.assets.filter(e).toArray())}static async validateAddAssets(e){if(!e.length)throw new Error("No assets to add");const n=e.map(d=>({...d,assetId:d.assetId.trim(),name:d.name?.trim(),symbol:d.symbol?.trim(),imageUrl:d.imageUrl?.trim()}));if(n.find(d=>!ia(d.assetId)))throw new Error("Asset with invalid assetId. Asset IDs can only be B256 addresses.");const s=n.filter((d,u)=>u===n.findIndex(f=>f.assetId===d.assetId));if(n.length!==s.length)throw new Error("Asset with same assetId being added multiple times");const i=n.filter((d,u)=>u===n.findIndex(f=>f.name===d.name));if(n.length!==i.length)throw new Error("Asset with same name being added multiple times");const o=n.filter((d,u)=>u===n.findIndex(f=>f.symbol===d.symbol));if(n.length!==o.length)throw new Error("Asset with same symbol being added multiple times");n.forEach(d=>{if(!Number.isInteger(d.decimals)||Number(d.decimals)>19||Number(d.decimals)<0)throw new Error(`Asset ${d.assetId} decimals is not valid`)});const a=s.map(d=>d.assetId),c=await rs.getAssetsByFilter(d=>a.indexOf(d.assetId)!==-1);if(c.length===s.length)throw new Error("Assets already exist in wallet settings");return{assetsToAdd:n.filter(d=>c.findIndex(u=>u.assetId===d.assetId)===-1)}}static async avoidRepeatedFields(e){const n=await rs.getAssets(),r=n.map(o=>o.name),s=n.map(o=>o.symbol);return e.reduce(async(o,a)=>{const c=await o,l=c.map(h=>h.name),d=c.map(h=>h.symbol),u=Kr({desired:a.name,allValues:[...r,...l]}),f=Kr({desired:a.symbol,allValues:[...s,...d]});return[...c,{...a,name:u,symbol:f,isCustom:!0}]},Promise.resolve([]))}}function Nd(t){let e;try{e=new URL(t)}catch{return!1}return e.protocol==="http:"||e.protocol==="https:"}function Ad(t){return t?t.includes("localhost")?Nd(t)&&t.endsWith("/graphql"):new RegExp("^https?:\\/\\/((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)&&t.endsWith("/graphql"):!1}class Ue{static getNetworks(){return p.transaction("r",p.networks,async()=>p.networks.toArray())}static getNetwork(e){return p.transaction("r",p.networks,async()=>p.networks.get({id:e.id}))}static async addNetwork(e){return await this.assertAddNetwork(e),p.transaction("rw",p.networks,async()=>{const n=await p.networks.count(),r={...e.data,...n===0&&{isSelected:!0},id:yi()},s=await p.networks.add(r);return p.networks.get(s)})}static updateNetwork(e){if(!e.data)throw new Error("Network.data undefined");if(!e.id)throw new Error("Network.id undefined");return p.transaction("rw",p.networks,async()=>(await p.networks.update(e.id,e.data),p.networks.get(e.id)))}static removeNetwork(e){return p.transaction("rw",p.networks,async()=>{const n=await Ue.getNetworks()||[];if(n.length===1)throw new Error("You need to stay with at least one network");const r=await Ue.getNetwork(e);if(r?.isSelected){const s=n.filter(i=>i.id!==e.id)[0];await Ue.selectNetwork({id:s.id})}return await p.networks.where(e).delete(),r?.id})}static getSelectedNetwork(){return p.transaction("r",p.networks,async()=>(await p.networks.toArray()).find(e=>e.isSelected))}static selectNetwork(e){return p.transaction("rw",p.networks,async()=>{const n=await p.networks.filter(r=>!!r.isSelected).first();return n?.id&&await Ue.updateNetwork({id:n.id,data:{isSelected:!1}}),await Ue.updateNetwork({id:e.id,data:{isSelected:!0}}),p.networks.get(e.id)})}static async addDefaultNetworks(){const e="https://beta-4.fuel.network/graphql",n=await Ue.getChainInfo({providerUrl:e}).catch(()=>({name:"Localhost"}));return Ue.addNetwork({data:{name:n.name,url:e}})}static clearNetworks(){return p.transaction("rw",p.networks,async()=>p.networks.clear())}static async getChainInfo(e){return(await Ht.create(e.providerUrl)).getChain()}static async getNodeInfo(e){return(await Ht.create(e.providerUrl)).fetchNode()}static async assertAddNetwork(e){const{name:n,url:r}=e.data;if(!Ad(r))throw new Error("Invalid network URL");if(await(await p.transaction("r",p.networks,async()=>p.networks.where("url").equalsIgnoreCase(r).or("name").equalsIgnoreCase(n))).count())throw new Error("Network with Name or URL already exists")}}class Ld{static async addAbi(e){return p.transaction("rw",p.abis,async()=>{const n=Object.keys(e.data).map(r=>({contractId:r,abi:e.data[r]}));return await p.abis.bulkAdd(n,void 0,{allKeys:!0}),!0})}static async getAbi(e){return p.transaction("r",p.abis,async()=>(await p.abis.get({contractId:e.data}))?.abi)}static async clearAbis(){return p.transaction("rw",p.abis,async()=>p.abis.clear())}}class Yd{static async addConnection(e){return p.transaction("rw",p.connections,async()=>(await p.connections.add(e.data),p.connections.get({origin:e.data.origin})))}static async removeConnection({origin:e}){return p.transaction("rw",p.connections,async()=>{const n=await p.connections.get({origin:e});return await p.connections.delete(e),n})}static async getConnection(e){return p.transaction("r",p.connections,async()=>p.connections.get({origin:e}))}static async clearConnections(){return p.transaction("rw",p.connections,async()=>p.connections.clear())}static async getConnections(){return p.transaction("r",p.connections,async()=>p.connections.toArray())}static getConnectedAccounts(e,n){return(e?.accounts||[]).map(s=>n.find(i=>i.address===s))}static async removeAccountFrom(e){const{origin:n,account:r}=e;return p.transaction("rw",p.connections,async()=>{const s=await p.connections.get({origin:n});return s&&(s.accounts=s.accounts.filter(i=>i!==r),await p.connections.put(s)),s})}static async addAccountTo(e){const{origin:n,account:r}=e;return p.transaction("rw",p.connections,async()=>{const s=await p.connections.get({origin:n});return s&&(s.accounts=s.accounts.concat(r),await p.connections.put(s)),s})}static async updateConnectedAccounts(e){const{origin:n,accounts:r}=e;return p.transaction("rw",p.connections,async()=>{const s=await p.connections.get({origin:n});return s&&(s.accounts=r,await p.connections.put(s)),s})}static filterByOrigin(e,n=""){return n.length?e.filter(pr(n)):null}static findByOrigin(e,n=""){return e.find(pr(n))}static excludeByOrigin(e,n=""){return n.length?e.filter(r=>!pr(n)(r)):e}}function pr(t){return e=>e.origin.toLowerCase().includes(t.toLowerCase()||"")}const qd=()=>chrome.runtime.getURL(`${oa.signup}#${aa.signUpWelcome()}`);export{Bt as A,Yd as C,mc as D,Ue as N,Fo as R,Ud as V,rs as a,Ld as b,p as c,Kd as d,Fd as e,Sc as f,Bd as g,Md as h,Ad as i,jd as t,$d as u,qd as w};
//# sourceMappingURL=config-039f390a.js.map
